
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Métodos basados en datos &#8212; Cartografía Geotécnica</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Métodos con base física" href="09_fisico.html" />
    <link rel="prev" title="Métodos basados en el conocimiento" href="07_heuristico.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Cartografía Geotécnica</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   .
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="00_medialuna.html">
   Media Luna (1954)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="00_introduccion.html">
   Introducción
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01_normatividad.html">
   Amenaza &amp; ordenamiento territorial
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_estadoarte.html">
   Estado del arte
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_metodos.html">
   Caracterización de movimientos en masa
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_susceptibilidad.html">
   Susceptibilidad y amenaza
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_inventario.html">
   Inventario de movimientos en masa
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_variables.html">
   Selección de variables predictoras
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07_heuristico.html">
   Métodos basados en el conocimiento
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Métodos basados en datos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09_fisico.html">
   Métodos con base física
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_evaluacion.html">
   Evaluación del modelo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11_detonante.html">
   Factores detonantes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12_amenaza.html">
   Amenaza
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13_flujos.html">
   Movimientos en masa tipo flujos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14_roca.html">
   Movimientos en masa en roca
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/08_estadistico.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/edieraristizabal/Libro_cartoGeotecnia"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/edieraristizabal/Libro_cartoGeotecnia/issues/new?title=Issue%20on%20page%20%2F08_estadistico.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/edieraristizabal/Libro_cartoGeotecnia/master?urlpath=tree/docs/08_estadistico.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bivariados">
   Bivariados
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#frequency-ratio-model-likelihood">
     <em>
      Frequency ratio model
     </em>
     (
     <em>
      Likelihood
     </em>
     )
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#python">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#statistical-index-model">
     <em>
      Statistical index model
     </em>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Python
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#peso-de-la-evidencia-woe">
     Peso de la evidencia (WoE)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Python
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evidential-belief-funtion-ebf">
     <em>
      Evidential Belief Funtion
     </em>
     (EBF)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#certainty-factor-cf">
     <em>
      Certainty Factor
     </em>
     (CF)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multivariados">
   Multivariados
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#metodo-de-analisis-condicional">
     Método de análisis condicional
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regresion-logistica">
     Regresión logística
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analisis-discriminante-lineal">
     Análisis discriminante lineal
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#support-vector-machine">
     <em>
      Support vector machine
     </em>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-forest">
     <em>
      Random forest
     </em>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#redes-neuronales">
     Redes neuronales
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#referencias">
   Referencias
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Métodos basados en datos</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bivariados">
   Bivariados
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#frequency-ratio-model-likelihood">
     <em>
      Frequency ratio model
     </em>
     (
     <em>
      Likelihood
     </em>
     )
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#python">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#statistical-index-model">
     <em>
      Statistical index model
     </em>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Python
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#peso-de-la-evidencia-woe">
     Peso de la evidencia (WoE)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Python
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evidential-belief-funtion-ebf">
     <em>
      Evidential Belief Funtion
     </em>
     (EBF)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#certainty-factor-cf">
     <em>
      Certainty Factor
     </em>
     (CF)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multivariados">
   Multivariados
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#metodo-de-analisis-condicional">
     Método de análisis condicional
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regresion-logistica">
     Regresión logística
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analisis-discriminante-lineal">
     Análisis discriminante lineal
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#support-vector-machine">
     <em>
      Support vector machine
     </em>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-forest">
     <em>
      Random forest
     </em>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#redes-neuronales">
     Redes neuronales
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       <em>
        Python
       </em>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#referencias">
   Referencias
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="metodos-basados-en-datos">
<h1>Métodos basados en datos<a class="headerlink" href="#metodos-basados-en-datos" title="Permalink to this headline">¶</a></h1>
<div class="section" id="bivariados">
<h2>Bivariados<a class="headerlink" href="#bivariados" title="Permalink to this headline">¶</a></h2>
<p>En los métodos bivariados cada mapa factor (geología, pendiente, coberturas, etc) es combinado con el inventario de movimientos en masa, para obtener los pesos de las clases que conforman las variables, basados generalmente en densidad de movimientos en masa. Los métodos estadísticos bivariados son una buena herramienta de aprendizaje para el analista encontrar qué factores o combinación de factores juegan un papel importante en la ocurrencia de movimientos en masa.</p>
<p>Como se mencionó anteriormente, estos métodos están basados en la asociación observada entre la distribución de los movimientos en masa y cada clase de la variable, lo que exige que cada variable sea transforamda a una variable categórica dividida por clases. De esta misma forma los métodos bivariados sólo permiten asignar peso a las clases y no a las variables, por lo que todas las variables tienen una importancia igual sobre la ocurrencia de movimientos en masa. Considerando esta desventaja, es muy común combinar los métodos estadísticos bivariados con métodos heurísticos como AHP para poder asignar peso a las variables.</p>
<p>Existe una gran cantidad de métodos estadísticos bivariados, los cuales se subdividen esencialmente en métodos basados en la densidad del número de movimientos en masa en cada clase (<em>Frequency ratio</em>, <em>Statistical index</em>), y los métodos basados en el teorema de Bayes (<em>Weight-of-evidence</em>, <em>Evidential belief function</em>,  <em>Certainty factor</em>).</p>
<div class="section" id="frequency-ratio-model-likelihood">
<h3><em>Frequency ratio model</em> (<em>Likelihood</em>)<a class="headerlink" href="#frequency-ratio-model-likelihood" title="Permalink to this headline">¶</a></h3>
<p>Este método, al igual que todos los métodos bivariados, calcula un peso para cada clase en la cual es dividida cada variable. En este caso el peso de la clase n (<span class="math notranslate nohighlight">\(w_n\)</span>) se calcula dividiendo la relación de la ocurrencia de movimientos en masa (<span class="math notranslate nohighlight">\(L_r\)</span>) por la relación del área de la clase (<span class="math notranslate nohighlight">\(A_r\)</span>):</p>
<p><span class="math notranslate nohighlight">\(w_n = \frac{L_r}{A_r}\)</span></p>
<p>Donde <span class="math notranslate nohighlight">\(L_r\)</span> es el porcentaje de movimientos en masa total que contiene la clase <span class="math notranslate nohighlight">\(n\)</span>, y <span class="math notranslate nohighlight">\(A_r\)</span> es el porcentaje del área total de representa dicha clase:</p>
<p><span class="math notranslate nohighlight">\(L_r = \frac{L_{clase}}{L_{total}}\)</span></p>
<p><span class="math notranslate nohighlight">\(A_r = \frac{A_{clase}}{A_{total}}\)</span></p>
<p>Finalmente, la susceptibilidad de una celda es igual a la sumatoria del peso de cada clase (<span class="math notranslate nohighlight">\(w\)</span>) a la que pertenece en cada variable:</p>
<p><span class="math notranslate nohighlight">\(S^n = \sum w = w_{pendiente} + w_{geologia} + w_{coberturas} + ...w_{n} \)</span></p>
<div class="figure align-default" id="likehood">
<a class="reference internal image-reference" href="https://www.researchgate.net/profile/Jangwon-Suh-3/publication/303875920/figure/fig1/AS:371153064480768&#64;1465501194778/Example-for-calculating-frequency-ratio-using-raster-grids-modified-from-Oh-et-al.png"><img alt="likehood" src="https://www.researchgate.net/profile/Jangwon-Suh-3/publication/303875920/figure/fig1/AS:371153064480768&#64;1465501194778/Example-for-calculating-frequency-ratio-using-raster-grids-modified-from-Oh-et-al.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 32 </span><span class="caption-text">Método de <em>Frequency ratio</em>. Tomado de Suh et al. (2015)</span><a class="headerlink" href="#likehood" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="python">
<h4><em>Python</em><a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h4>
<p>En el presente ejemplo, y solo con propósitos pedagógicos, se utilizarán solo tres variables (pendiente, geologia, aspecto) pero el procedimiento señalado se debera utilizar para todas las variables incorporadas en el modelo de susceptibilidad.</p>
<p>Inicialmente se procede a importar las librerías a utilizar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install rasterio
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: rasterio in c:\users\usuario\miniconda3\envs\geospatial\lib\site-packages (1.2.1)
Requirement already satisfied: affine in c:\users\usuario\miniconda3\envs\geospatial\lib\site-packages (from rasterio) (2.3.0)
Requirement already satisfied: attrs in c:\users\usuario\miniconda3\envs\geospatial\lib\site-packages (from rasterio) (20.3.0)
Requirement already satisfied: certifi in c:\users\usuario\miniconda3\envs\geospatial\lib\site-packages (from rasterio) (2022.6.15)
Requirement already satisfied: click&lt;8,&gt;=4.0 in c:\users\usuario\miniconda3\envs\geospatial\lib\site-packages (from rasterio) (7.1.2)
Requirement already satisfied: cligj&gt;=0.5 in c:\users\usuario\miniconda3\envs\geospatial\lib\site-packages (from rasterio) (0.7.1)
Requirement already satisfied: numpy in c:\users\usuario\miniconda3\envs\geospatial\lib\site-packages (from rasterio) (1.20.1)
Requirement already satisfied: snuggs&gt;=1.4.1 in c:\users\usuario\miniconda3\envs\geospatial\lib\site-packages (from rasterio) (1.4.7)
Requirement already satisfied: click-plugins in c:\users\usuario\miniconda3\envs\geospatial\lib\site-packages (from rasterio) (1.1.1)
Requirement already satisfied: pyparsing&gt;=2.1.6 in c:\users\usuario\miniconda3\envs\geospatial\lib\site-packages (from snuggs&gt;=1.4.1-&gt;rasterio) (2.4.7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rasterio</span> <span class="k">as</span> <span class="nn">rio</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_10864</span><span class="o">/</span><span class="mf">1877902076.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">rasterio</span> <span class="k">as</span> <span class="nn">rio</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;matplotlib&#39;
</pre></div>
</div>
</div>
</div>
<p>A continuación se importa el inventario de movimientos en masa, así como los mapas de las variables predictoras a utilizar:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/edieraristizabal/Libro_cartoGeotecnia/blob/master/data/Inventario_MenM.tif?raw=true&#39;</span><span class="p">)</span>
<span class="n">inventario</span><span class="o">=</span><span class="n">raster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">raster_mask</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/edieraristizabal/Libro_cartoGeotecnia/blob/master/data/Pendiente.tif?raw=true&#39;</span><span class="p">)</span>
<span class="n">msk</span><span class="o">=</span><span class="n">raster_mask</span><span class="o">.</span><span class="n">read_masks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">msk</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">msk</span><span class="o">==</span><span class="mi">255</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">inventario</span><span class="o">=</span><span class="n">msk</span><span class="o">*</span><span class="n">inventario</span>
<span class="n">inventario_vector</span><span class="o">=</span><span class="n">inventario</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">inventario_vector_MenM</span><span class="o">=</span><span class="n">inventario_vector</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">inventario_vector</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">inventario</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">inventario_vector_MenM</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(910801,)
</pre></div>
</div>
<img alt="_images/08_estadistico_8_1.png" src="_images/08_estadistico_8_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/edieraristizabal/Libro_cartoGeotecnia/blob/master/data/Pendiente.tif?raw=true&#39;</span><span class="p">)</span>
<span class="n">pendiente</span><span class="o">=</span><span class="n">raster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pendiente</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pendiente</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">pendiente</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pendiente</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
<span class="n">pendiente_vector</span><span class="o">=</span><span class="n">pendiente</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">pendiente_vector_MenM</span><span class="o">=</span><span class="n">pendiente_vector</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pendiente_vector</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08_estadistico_9_0.png" src="_images/08_estadistico_9_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/edieraristizabal/Libro_cartoGeotecnia/blob/master/data/Aspecto.tif?raw=true&#39;</span><span class="p">)</span>
<span class="n">aspecto</span><span class="o">=</span><span class="n">raster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">aspecto</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aspecto</span><span class="o">&lt;-</span><span class="mi">100</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">aspecto</span><span class="p">)</span>
<span class="n">aspecto_vector</span><span class="o">=</span><span class="n">aspecto</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">aspecto_vector_MenM</span><span class="o">=</span><span class="n">aspecto_vector</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">aspecto_vector</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aspecto</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x7f3da1621490&gt;
</pre></div>
</div>
<img alt="_images/08_estadistico_10_1.png" src="_images/08_estadistico_10_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/edieraristizabal/Libro_cartoGeotecnia/blob/master/data/Geologia_Superficial.tif?raw=true&#39;</span><span class="p">)</span>
<span class="n">geologia</span><span class="o">=</span><span class="n">raster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">geologia</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">geologia</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">geologia</span><span class="p">)</span>
<span class="n">geologia_vector</span><span class="o">=</span><span class="n">geologia</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">geologia_vector_MenM</span><span class="o">=</span><span class="n">geologia_vector</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">geologia_vector</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">geologia</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08_estadistico_11_0.png" src="_images/08_estadistico_11_0.png" />
</div>
</div>
<p>Para implementar todos lo métodos estadísticos bivariados se deben conocer para cada clase de las variables, el número de celdas que pertenecen a dicha clase y el número de celdas con MenM.</p>
<p>A continuación se presenta el procedimiento para el mapa de pendiente, el cual es una variable continua. Como se mencionó anteriormente en los metodos estadísticos bivariados se deben transformar las variables continuas a categóricas. En este caso el mapa de pendientes se convierte a 5 clases [0-10, 10-20, 20-30, 30-35, &gt;35].</p>
<p>Para realizar este procedimiento se utiliza el vector que se generó con el mapa de pendiente, y se convierte a una serie de Pandas, de tal forma que permita iterar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pendiente_serie</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pendiente_vector_MenM</span><span class="p">)</span>
<span class="n">ap</span><span class="o">=</span><span class="n">bp</span><span class="o">=</span><span class="n">cp</span><span class="o">=</span><span class="n">dp</span><span class="o">=</span><span class="n">ep</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pendiente_serie</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">):</span>
          <span class="n">ap</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">10</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">):</span>
          <span class="n">bp</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">20</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">):</span>
          <span class="n">cp</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">30</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">35</span><span class="p">):</span>
          <span class="n">dp</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="o">&gt;=</span><span class="mi">35</span><span class="p">):</span>
          <span class="n">ep</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">totalp</span><span class="o">=</span><span class="n">ap</span><span class="o">+</span><span class="n">bp</span><span class="o">+</span><span class="n">cp</span><span class="o">+</span><span class="n">dp</span><span class="o">+</span><span class="n">ep</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;total:&quot;</span><span class="p">,</span> <span class="n">totalp</span><span class="p">,</span><span class="n">ap</span><span class="p">,</span><span class="n">bp</span><span class="p">,</span><span class="n">cp</span><span class="p">,</span><span class="n">dp</span><span class="p">,</span><span class="n">ep</span><span class="p">)</span>

<span class="n">pendienteconMenM</span><span class="o">=</span><span class="n">pendiente_vector_MenM</span><span class="o">*</span><span class="n">inventario_vector_MenM</span>
<span class="n">ap1</span><span class="o">=</span><span class="n">bp1</span><span class="o">=</span><span class="n">cp1</span><span class="o">=</span><span class="n">dp1</span><span class="o">=</span><span class="n">ep1</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pendienteconMenM</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">):</span>
          <span class="n">ap1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">10</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">):</span>
          <span class="n">bp1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">20</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">):</span>
          <span class="n">cp1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">30</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">35</span><span class="p">):</span>
          <span class="n">dp1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="o">&gt;=</span><span class="mi">35</span><span class="p">):</span>
          <span class="n">ep1</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">total1p</span><span class="o">=</span><span class="n">ap1</span><span class="o">+</span><span class="n">bp1</span><span class="o">+</span><span class="n">cp1</span><span class="o">+</span><span class="n">dp1</span><span class="o">+</span><span class="n">ep1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;total1:&quot;</span><span class="p">,</span> <span class="n">total1p</span><span class="p">,</span><span class="n">ap1</span><span class="p">,</span><span class="n">bp1</span><span class="p">,</span><span class="n">cp1</span><span class="p">,</span><span class="n">dp1</span><span class="p">,</span><span class="n">ep1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total: 910801 53805 138684 279488 158011 280813
total1: 1620 13 108 411 301 787
</pre></div>
</div>
</div>
</div>
<p>Ahora se calcula el <em>Frequency ratio</em> para cada clase a partir de los valores estimados previamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w_a</span><span class="o">=</span><span class="p">(</span><span class="n">ap1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ap</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_b</span><span class="o">=</span><span class="p">(</span><span class="n">bp1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">bp</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_c</span><span class="o">=</span><span class="p">(</span><span class="n">cp1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cp</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_d</span><span class="o">=</span><span class="p">(</span><span class="n">dp1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dp</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_e</span><span class="o">=</span><span class="p">(</span><span class="n">ep1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ep</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">w_a</span><span class="p">,</span><span class="n">w_b</span><span class="p">,</span><span class="n">w_c</span><span class="p">,</span><span class="n">w_d</span><span class="p">,</span><span class="n">w_e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13584047790317347 0.4378303673579264 0.826774627307924 1.0709955300033418 1.5756726885555798
</pre></div>
</div>
</div>
</div>
<p>Finalmente se reclasifica el mapa, asignándole a cada clase el valor del <em>Frequency ratio</em> calculado:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pendiente</span><span class="o">&lt;</span><span class="mi">10</span> <span class="p">)),</span><span class="n">w_a</span><span class="p">,</span><span class="n">pendiente</span> <span class="p">)</span>
<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">20</span> <span class="p">)),</span><span class="n">w_b</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>
<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">30</span> <span class="p">)),</span><span class="n">w_c</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>
<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">35</span> <span class="p">)),</span><span class="n">w_d</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>
<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">35</span><span class="p">,</span><span class="n">w_e</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pendiente_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pendiente_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.13584048 0.43783036 0.82677466 1.0709956  1.5756727         nan]
</pre></div>
</div>
<img alt="_images/08_estadistico_17_1.png" src="_images/08_estadistico_17_1.png" />
</div>
</div>
<p>Ahora se realiza el mismo procedimiento para la variable <em>aspecto</em>, la cual tambien es continua, en este caso se divide en 4 clases [0-90, 90-180, 180-270, 270-360]:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aspecto_serie</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">aspecto_vector_MenM</span><span class="p">)</span>
<span class="n">aa</span><span class="o">=</span><span class="n">ba</span><span class="o">=</span><span class="n">ca</span><span class="o">=</span><span class="n">da</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">aspecto_serie</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">):</span>
          <span class="n">aa</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">90</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">):</span>
          <span class="n">ba</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">180</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">270</span><span class="p">):</span>
          <span class="n">ca</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="o">&gt;=</span><span class="mi">270</span><span class="p">):</span>
          <span class="n">da</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">totala</span><span class="o">=</span><span class="n">aa</span><span class="o">+</span><span class="n">ba</span><span class="o">+</span><span class="n">ca</span><span class="o">+</span><span class="n">da</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;total:&quot;</span><span class="p">,</span> <span class="n">totala</span><span class="p">,</span><span class="n">aa</span><span class="p">,</span><span class="n">ba</span><span class="p">,</span><span class="n">ca</span><span class="p">,</span><span class="n">da</span><span class="p">)</span>

<span class="n">aspectoconMenM</span><span class="o">=</span><span class="n">aspecto_vector_MenM</span><span class="o">*</span><span class="n">inventario_vector_MenM</span>
<span class="n">aa1</span><span class="o">=</span><span class="n">ba1</span><span class="o">=</span><span class="n">ca1</span><span class="o">=</span><span class="n">da1</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">aspectoconMenM</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">):</span>
          <span class="n">aa1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">90</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">):</span>
          <span class="n">ba1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">180</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">270</span><span class="p">):</span>
          <span class="n">ca1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="o">&gt;=</span><span class="mi">270</span><span class="p">):</span>
          <span class="n">da1</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">total1a</span><span class="o">=</span><span class="n">aa1</span><span class="o">+</span><span class="n">ba1</span><span class="o">+</span><span class="n">ca1</span><span class="o">+</span><span class="n">da1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;total1:&quot;</span><span class="p">,</span> <span class="n">total1a</span><span class="p">,</span><span class="n">aa1</span><span class="p">,</span><span class="n">ba1</span><span class="p">,</span><span class="n">ca1</span><span class="p">,</span><span class="n">da1</span><span class="p">)</span>

<span class="n">w_a</span><span class="o">=</span><span class="p">(</span><span class="n">aa1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">aa</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_b</span><span class="o">=</span><span class="p">(</span><span class="n">ba1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ba</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_c</span><span class="o">=</span><span class="p">(</span><span class="n">ca1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ca</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_d</span><span class="o">=</span><span class="p">(</span><span class="n">da1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">da</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;w:&quot;</span><span class="p">,</span> <span class="n">w_a</span><span class="p">,</span><span class="n">w_b</span><span class="p">,</span><span class="n">w_c</span><span class="p">,</span><span class="n">w_d</span><span class="p">)</span>

<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">aspecto</span><span class="o">&lt;</span><span class="mi">90</span> <span class="p">)),</span><span class="n">w_a</span><span class="p">,</span><span class="n">aspecto</span> <span class="p">)</span>
<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">90</span><span class="p">,</span> <span class="n">aspecto_c</span><span class="o">&lt;</span><span class="mi">180</span> <span class="p">)),</span><span class="n">w_b</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>
<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">180</span><span class="p">,</span> <span class="n">aspecto_c</span><span class="o">&lt;</span><span class="mi">270</span> <span class="p">)),</span><span class="n">w_c</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>
<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">270</span><span class="p">,</span><span class="n">w_d</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aspecto_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">aspecto_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total: 909599 151110 128456 306544 323489
total1: 1620 271 401 469 479
w: 1.0069572774636415 1.7527700266488904 0.8590431563124444 0.8314017909437948
[-1.          0.83140177  0.8590432   1.0069573   1.7527701          nan]
</pre></div>
</div>
<img alt="_images/08_estadistico_19_1.png" src="_images/08_estadistico_19_1.png" />
</div>
</div>
<p>Y el mismo procedimiento para la variable <em>geologia</em>, la cual es categórica por lo cual ligeramente varía el procedimiento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ag</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">bg</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">cg</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">dg</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">eg</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">fg</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">gg</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">hg</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">14</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">ig</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">jg</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">totalg</span><span class="o">=</span><span class="n">ag</span><span class="o">+</span><span class="n">bg</span><span class="o">+</span><span class="n">cg</span><span class="o">+</span><span class="n">dg</span><span class="o">+</span><span class="n">eg</span><span class="o">+</span><span class="n">fg</span><span class="o">+</span><span class="n">gg</span><span class="o">+</span><span class="n">hg</span><span class="o">+</span><span class="n">ig</span><span class="o">+</span><span class="n">jg</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="n">totalg</span><span class="p">,</span><span class="n">ag</span><span class="p">,</span><span class="n">bg</span><span class="p">,</span><span class="n">cg</span><span class="p">,</span><span class="n">dg</span><span class="p">,</span><span class="n">eg</span><span class="p">,</span><span class="n">fg</span><span class="p">,</span><span class="n">gg</span><span class="p">,</span><span class="n">hg</span><span class="p">,</span><span class="n">ig</span><span class="p">,</span><span class="n">jg</span><span class="p">)</span>

<span class="n">geologiaconMenM</span><span class="o">=</span><span class="n">geologia</span><span class="o">*</span><span class="n">inventario</span>
<span class="n">ag1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">bg1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">cg1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">dg1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">eg1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">fg1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">gg1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">hg1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">14</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">ig1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">jg1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">totalg1</span><span class="o">=</span><span class="n">ag1</span><span class="o">+</span><span class="n">bg1</span><span class="o">+</span><span class="n">cg1</span><span class="o">+</span><span class="n">dg1</span><span class="o">+</span><span class="n">eg1</span><span class="o">+</span><span class="n">fg1</span><span class="o">+</span><span class="n">gg1</span><span class="o">+</span><span class="n">hg1</span><span class="o">+</span><span class="n">ig1</span><span class="o">+</span><span class="n">jg1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;total1&quot;</span><span class="p">,</span> <span class="n">totalg1</span><span class="p">,</span><span class="n">ag1</span><span class="p">,</span><span class="n">bg1</span><span class="p">,</span><span class="n">cg1</span><span class="p">,</span><span class="n">dg1</span><span class="p">,</span><span class="n">eg1</span><span class="p">,</span><span class="n">fg1</span><span class="p">,</span><span class="n">gg1</span><span class="p">,</span><span class="n">hg1</span><span class="p">,</span><span class="n">ig1</span><span class="p">,</span><span class="n">jg1</span><span class="p">)</span>

<span class="n">w_a</span><span class="o">=</span><span class="p">(</span><span class="n">ag1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ag</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_b</span><span class="o">=</span><span class="p">(</span><span class="n">bg1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">bg</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_c</span><span class="o">=</span><span class="p">(</span><span class="n">cg1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cg</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_d</span><span class="o">=</span><span class="p">(</span><span class="n">dg1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dg</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_e</span><span class="o">=</span><span class="p">(</span><span class="n">eg1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">eg</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_f</span><span class="o">=</span><span class="p">(</span><span class="n">fg1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">fg</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_g</span><span class="o">=</span><span class="p">(</span><span class="n">gg1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">gg</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_h</span><span class="o">=</span><span class="p">(</span><span class="n">hg1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">hg</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_i</span><span class="o">=</span><span class="p">(</span><span class="n">ig1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ig</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="n">w_j</span><span class="o">=</span><span class="p">(</span><span class="n">jg1</span><span class="o">/</span><span class="n">total1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">jg</span><span class="o">/</span><span class="n">total</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;w:&quot;</span><span class="p">,</span> <span class="n">w_a</span><span class="p">,</span><span class="n">w_b</span><span class="p">,</span><span class="n">w_c</span><span class="p">,</span><span class="n">w_d</span><span class="p">,</span><span class="n">w_e</span><span class="p">,</span><span class="n">w_f</span><span class="p">,</span><span class="n">w_g</span><span class="p">,</span><span class="n">w_h</span><span class="p">,</span><span class="n">w_i</span><span class="p">,</span><span class="n">w_j</span><span class="p">)</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="n">w_a</span><span class="p">,</span><span class="n">geologia</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">4</span><span class="p">,</span><span class="n">w_b</span><span class="p">,</span><span class="n">geologia_c</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">6</span><span class="p">,</span><span class="n">w_c</span><span class="p">,</span><span class="n">geologia_c</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">8</span><span class="p">,</span><span class="n">w_d</span><span class="p">,</span><span class="n">geologia_c</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">9</span><span class="p">,</span><span class="n">w_e</span><span class="p">,</span><span class="n">geologia_c</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">10</span><span class="p">,</span><span class="n">w_f</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">11</span><span class="p">,</span><span class="n">w_g</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">14</span><span class="p">,</span><span class="n">w_h</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">15</span><span class="p">,</span><span class="n">w_i</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">16</span><span class="p">,</span><span class="n">w_j</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">geologia_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">geologia_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total 910801 237383 169 3060 32352 37658 22405 41720 515621 1850 18583
total1 1620 612 0 0 98 0 43 118 736 13 0
w: 1.447560646250527 0.0 0.0 1.7008260599455374 0.0 1.077602194175132 1.5880810636459406 0.8014606000325486 3.945541207874541 0.0
[0.         0.8014606  1.07760219 1.44756065 1.58808106 1.70082606
 3.94554121        nan]
</pre></div>
</div>
<img alt="_images/08_estadistico_21_1.png" src="_images/08_estadistico_21_1.png" />
</div>
</div>
<p>Con los mapas de cada variable reclasificados de acuerdo con el valor de <em>Frequency ratio</em> se procede entonces a sumar todas las variables y obtener el mapa de susceptibilidad:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS</span><span class="o">=</span><span class="n">pendiente_c</span><span class="o">+</span><span class="n">aspecto_c</span><span class="o">+</span><span class="n">geologia_c</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">IS</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08_estadistico_23_0.png" src="_images/08_estadistico_23_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="statistical-index-model">
<h3><em>Statistical index model</em><a class="headerlink" href="#statistical-index-model" title="Permalink to this headline">¶</a></h3>
<p>El valor del peso para cada clase en el método <em>Statistical index model</em> es definido como el logaritmo natural de la densidad de movimientos en masa en una clase (<span class="math notranslate nohighlight">\(\rho_{clase}\)</span>) dividido la densidad de deslizamientos en toda la zona de estudio (<span class="math notranslate nohighlight">\(\rho_{total}\)</span>), de acuerdo con la siguiente ecuación:</p>
<p><span class="math notranslate nohighlight">\(w_{ij}^n = \ln(\frac{\rho_{clase}}{\rho_{total}}) = \ln(\frac{\frac{N_{ij}}{S_{ij}}}{\frac{N}{S}}) \)</span></p>
<p>Donde <span class="math notranslate nohighlight">\(w_{ij}^n\)</span> es el peso de la celda <span class="math notranslate nohighlight">\(n\)</span> que pertenece a la clase <span class="math notranslate nohighlight">\(i\)</span> de la variable <span class="math notranslate nohighlight">\(j\)</span>. <span class="math notranslate nohighlight">\(\rho_{clase}\)</span> es la densidad de deslizamientos de la clase <span class="math notranslate nohighlight">\(i\)</span> del parámetro <span class="math notranslate nohighlight">\(j\)</span>, calculado a  partir de <span class="math notranslate nohighlight">\(N_{ij}\)</span> como el número de pixeles con MenM en una cierta clase <span class="math notranslate nohighlight">\(i\)</span> del parametro <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(S_{ij} como el número de pixeles de la clase \)</span>i<span class="math notranslate nohighlight">\( del parametro \)</span>j$. N es el total de celdas que corresponden a deslizamientos en todo el mapa y S es el total de celdas del área de estudio.</p>
<p>Finalmente la susceptibilidad a movimientos en masa de cada celda es igual a:</p>
<p><span class="math notranslate nohighlight">\(S^n = \sum w = w_{pendiente} + w_{geologia} + w_{coberturas} + ...w_{n} \)</span></p>
<div class="section" id="id1">
<h4>Python<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Para el método de <em>Statistical index</em> se debe calcular la densidad de movimientos en masa, tanto para las clases de cada variable, como para el área total.</p>
<p>La densidad total es igual a:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span><span class="o">=</span><span class="n">total1</span><span class="o">/</span><span class="n">total</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0017810045965309987
</pre></div>
</div>
</div>
</div>
<p>La densidad para las 5 clases de pendiente se estiman de la siguiente manera:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">ap1</span><span class="o">/</span><span class="n">ap</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">bp1</span><span class="o">/</span><span class="n">bp</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">cp1</span><span class="o">/</span><span class="n">cp</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">dp1</span><span class="o">/</span><span class="n">dp</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_e</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">ep1</span><span class="o">/</span><span class="n">ep</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">w_a</span><span class="p">,</span><span class="n">w_b</span><span class="p">,</span><span class="n">w_c</span><span class="p">,</span><span class="n">w_d</span><span class="p">,</span><span class="n">w_e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.9975946273658713 -0.8272443218321374 -0.19154372854191365 0.0672680287170693 0.4533616958660388
</pre></div>
</div>
</div>
</div>
<p>Con estos valores del <em>statistical index</em> se reclasifica el mapa de pendientes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pendiente</span><span class="o">&lt;</span><span class="mi">10</span> <span class="p">)),</span><span class="n">w_a</span><span class="p">,</span><span class="n">pendiente</span> <span class="p">)</span>
<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">20</span> <span class="p">)),</span><span class="n">w_b</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>
<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">30</span> <span class="p">)),</span><span class="n">w_c</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>
<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">35</span> <span class="p">)),</span><span class="n">w_d</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>
<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">35</span><span class="p">,</span><span class="n">w_e</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pendiente_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pendiente_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1.9975946  -0.82724434 -0.19154373  0.06726803  0.4533617          nan]
</pre></div>
</div>
<img alt="_images/08_estadistico_31_1.png" src="_images/08_estadistico_31_1.png" />
</div>
</div>
<p>Realizamos el mismo procedimiento para la variable <em>aspecto</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">aa1</span><span class="o">/</span><span class="n">aa</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">ba1</span><span class="o">/</span><span class="n">ba</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">ca1</span><span class="o">/</span><span class="n">ca</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">da1</span><span class="o">/</span><span class="n">da</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;w:&quot;</span><span class="p">,</span> <span class="n">w_a</span><span class="p">,</span><span class="n">w_b</span><span class="p">,</span><span class="n">w_c</span><span class="p">,</span><span class="n">w_d</span><span class="p">)</span>

<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">aspecto</span><span class="o">&lt;</span><span class="mi">90</span> <span class="p">)),</span><span class="n">w_a</span><span class="p">,</span><span class="n">aspecto</span> <span class="p">)</span>
<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">90</span><span class="p">,</span> <span class="n">aspecto_c</span><span class="o">&lt;</span><span class="mi">180</span> <span class="p">)),</span><span class="n">w_b</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>
<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">180</span><span class="p">,</span> <span class="n">aspecto_c</span><span class="o">&lt;</span><span class="mi">270</span> <span class="p">)),</span><span class="n">w_c</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>
<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">270</span><span class="p">,</span><span class="n">w_d</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aspecto_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">aspecto_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>w: 0.006933187278979516 0.5611974088841332 -0.1519361180824098 -0.18464209803578424
[-1.         -0.18464209 -0.15193611  0.00693319  0.5611974          nan]
</pre></div>
</div>
<img alt="_images/08_estadistico_33_1.png" src="_images/08_estadistico_33_1.png" />
</div>
</div>
<p>Para la variable geología se debe tener en cuenta que existen algunas clases que no presentan celdas con MenM, por lo tanto generan un error al calcular el logaritmo. Para superar est se le asigna un valor de 1 a dichas clases.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bg1</span><span class="o">=</span><span class="n">cg1</span><span class="o">=</span><span class="n">eg1</span><span class="o">=</span><span class="n">jg1</span><span class="o">=</span><span class="mi">1</span>   <span class="c1">#clases que obtuvieron 0 celdas con movimientos en masa</span>

<span class="n">w_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">ag1</span><span class="o">/</span><span class="n">ag</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">bg1</span><span class="o">/</span><span class="n">bg</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">cg1</span><span class="o">/</span><span class="n">cg</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">dg1</span><span class="o">/</span><span class="n">dg</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_e</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">eg1</span><span class="o">/</span><span class="n">eg</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">fg1</span><span class="o">/</span><span class="n">fg</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_g</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">gg1</span><span class="o">/</span><span class="n">gg</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">hg1</span><span class="o">/</span><span class="n">hg</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_i</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">ig1</span><span class="o">/</span><span class="n">ig</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="n">w_j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">jg1</span><span class="o">/</span><span class="n">jg</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;w:&quot;</span><span class="p">,</span> <span class="n">w_a</span><span class="p">,</span><span class="n">w_b</span><span class="p">,</span><span class="n">w_c</span><span class="p">,</span><span class="n">w_d</span><span class="p">,</span><span class="n">w_e</span><span class="p">,</span><span class="n">w_f</span><span class="p">,</span><span class="n">w_g</span><span class="p">,</span><span class="n">w_h</span><span class="p">,</span><span class="n">w_i</span><span class="p">,</span><span class="n">w_j</span><span class="p">)</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="n">w_a</span><span class="p">,</span><span class="n">geologia</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">4</span><span class="p">,</span><span class="n">w_b</span><span class="p">,</span><span class="n">geologia_c</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">6</span><span class="p">,</span><span class="n">w_c</span><span class="p">,</span><span class="n">geologia_c</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">8</span><span class="p">,</span><span class="n">w_d</span><span class="p">,</span><span class="n">geologia_c</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">9</span><span class="p">,</span><span class="n">w_e</span><span class="p">,</span><span class="n">geologia_c</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">10</span><span class="p">,</span><span class="n">w_f</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">11</span><span class="p">,</span><span class="n">w_g</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">14</span><span class="p">,</span><span class="n">w_h</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">15</span><span class="p">,</span><span class="n">w_i</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">16</span><span class="p">,</span><span class="n">w_j</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">geologia_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">geologia_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>w: 0.36987982682432763 1.200678978884011 -1.695592501139342 0.5311140506574584 -4.205723000249289 0.07473838228040365 0.4625264091580406 -0.22131946592927398 1.3725861331962508 -3.499424769466566
[-4.205723   -3.49942477 -1.6955925  -0.22131947  0.07473838  0.36987983
  0.46252641  0.53111405  1.20067898  1.37258613         nan]
</pre></div>
</div>
<img alt="_images/08_estadistico_35_1.png" src="_images/08_estadistico_35_1.png" />
</div>
</div>
<p>Con los mapas de cada variable reclasificados de acuerdo con el valor de <em>Statistical index</em> se procede entonces a sumar todas las variables y obtener el mapa de susceptibilidad:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS</span><span class="o">=</span><span class="n">pendiente_c</span><span class="o">+</span><span class="n">aspecto_c</span><span class="o">+</span><span class="n">geologia_c</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">IS</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08_estadistico_37_0.png" src="_images/08_estadistico_37_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="peso-de-la-evidencia-woe">
<h3>Peso de la evidencia (WoE)<a class="headerlink" href="#peso-de-la-evidencia-woe" title="Permalink to this headline">¶</a></h3>
<p>El Peso de la Evidencia, basado en la teoría de la probabilidad Bayesiana, analiza la relación entre las áreas afectadas
por los movimientos en masa y la distribución espacial de los factores condicionantes del terreno. Este método arroja
los pesos de las clases que conforman las variables condicionantes, indicando la presencia e influencia de la clase como parámetro
en la ocurrencia del movimiento en masa. Los pesos positivos (W+)  indican la presencia de la clase como parámetro que
favorece los movimientos en masa y su magnitud indica su correlación. El peso negativo (W-) indica la ausencia de la clase en la ocurrencia de
movimiento en masa.</p>
<p>Dónde <span class="math notranslate nohighlight">\(N_{pix1}\)</span> es el número de pixeles con movimientos en masa (<span class="math notranslate nohighlight">\(S\)</span>) en la clase <span class="math notranslate nohighlight">\(B_i\)</span>, <span class="math notranslate nohighlight">\(N_{pix2}\)</span> número de pixeles con movimientos
en masa que no están presentes en la misma clase <span class="math notranslate nohighlight">\(\hat{B}_i\)</span>, <span class="math notranslate nohighlight">\(N_{pix3}\)</span> es el número de pixeles en la clase que no hay movimientos
en masa <span class="math notranslate nohighlight">\(\hat{S}\)</span> y <span class="math notranslate nohighlight">\(N_{pix4}\)</span> es el número de pixeles en la clase donde no hay movimientos en masa <span class="math notranslate nohighlight">\(\hat{S}\)</span> y que no está presente en
la clase  <span class="math notranslate nohighlight">\(\hat{B}_i\)</span>.</p>
<div class="figure align-default" id="woe">
<a class="reference internal image-reference" href="https://i.pinimg.com/564x/70/a4/d5/70a4d5ecbab6d6bf9bdb0f914c91dba8.jpg"><img alt="woe" src="https://i.pinimg.com/564x/70/a4/d5/70a4d5ecbab6d6bf9bdb0f914c91dba8.jpg" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 33 </span><span class="caption-text">Método de Peso de la Evidencia.</span><a class="headerlink" href="#woe" title="Permalink to this image">¶</a></p>
</div>
<p><span class="math notranslate nohighlight">\(C = W^+ - W^-\)</span></p>
<p>Y el contraste C refleja el espacio de asociación respecto a la clase en la predicción del movimiento en masa, la cual
es cero cuando la clase no afecta, es positivo cuando existe una correlación directa y negativo cuando existe una correlación inversa con la distribución de movimientos en masa.</p>
<div class="section" id="id2">
<h4>Python<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Para calcular el <span class="math notranslate nohighlight">\(W^+\)</span> (wp), <span class="math notranslate nohighlight">\(W^-\)</span> (wn), y <span class="math notranslate nohighlight">\(C\)</span> de cada clase se utilizan las siguientes ecuaciones del método WoE: <span class="math notranslate nohighlight">\(N_{pix1}\)</span>=a1, son las celdas que pertenecen a la clase a y tienen MenM. <span class="math notranslate nohighlight">\(N_{pix2}\)</span>=total1-a1, son las celdas que no pertenecen a la clase a y que tienen MenM, <span class="math notranslate nohighlight">\(N_{pix3}\)</span>=a-a1, son las celdas que pertenecen a la clase a pero que no tienen MenM. y <span class="math notranslate nohighlight">\(N_{pix4}\)</span>=(b+c+d+e)-(b1+c1+d1+e1), son las celdas que no pertenecen a la clase a y que no tienen MenM.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="o">=</span><span class="n">ap1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">ap1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">ap</span><span class="o">-</span><span class="n">ap1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">bp</span><span class="o">+</span><span class="n">cp</span><span class="o">+</span><span class="n">dp</span><span class="o">+</span><span class="n">ep</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">bp1</span><span class="o">+</span><span class="n">cp1</span><span class="o">+</span><span class="n">dp1</span><span class="o">+</span><span class="n">ep1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Con los valores de x1, x2, x3, x4 se calculan el <span class="math notranslate nohighlight">\(W^+\)</span> (wp), el <span class="math notranslate nohighlight">\(W^-\)</span> (Wn) y el Contraste de la siguiente forma:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wp_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wp_a</span><span class="p">,</span> <span class="n">wn_a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.9978126337233664 0.05293079554963469 -2.0507434292730014
</pre></div>
</div>
</div>
</div>
<p>Con el valor del contraste para la clase <span class="math notranslate nohighlight">\(a\)</span> del mapa de pendiente, se genera un mapa de pendiente reclasificado donde todas las celdas que pertenezcan a la clase a ahora tengan el valor del contraste de <span class="math notranslate nohighlight">\(a\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pendiente</span><span class="o">&lt;</span><span class="mi">10</span> <span class="p">)),</span><span class="n">c</span><span class="p">,</span><span class="n">pendiente</span> <span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Ahora se repite el mismo procedimiento para cada una de las clases en las cuales se clasificó el mapa de pendientes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Clase b</span>
<span class="n">x1</span><span class="o">=</span><span class="n">bp1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">bp1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">bp</span><span class="o">-</span><span class="n">bp1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ap</span><span class="o">+</span><span class="n">cp</span><span class="o">+</span><span class="n">dp</span><span class="o">+</span><span class="n">ep</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ap1</span><span class="o">+</span><span class="n">cp1</span><span class="o">+</span><span class="n">dp1</span><span class="o">+</span><span class="n">ep1</span><span class="p">)</span>

<span class="n">wp_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">20</span> <span class="p">)),</span><span class="n">cont</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>

<span class="c1">#Clase c</span>
<span class="n">x1</span><span class="o">=</span><span class="n">cp1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">cp1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">cp</span><span class="o">-</span><span class="n">cp1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ap</span><span class="o">+</span><span class="n">bp</span><span class="o">+</span><span class="n">dp</span><span class="o">+</span><span class="n">ep</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ap1</span><span class="o">+</span><span class="n">bp1</span><span class="o">+</span><span class="n">dp1</span><span class="o">+</span><span class="n">ep1</span><span class="p">)</span>

<span class="n">wp_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">20</span> <span class="p">)),</span><span class="n">cont</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>

<span class="c1">#Clase d</span>
<span class="n">x1</span><span class="o">=</span><span class="n">dp1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">dp1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">dp</span><span class="o">-</span><span class="n">dp1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ap</span><span class="o">+</span><span class="n">bp</span><span class="o">+</span><span class="n">cp</span><span class="o">+</span><span class="n">ep</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ap1</span><span class="o">+</span><span class="n">bp1</span><span class="o">+</span><span class="n">cp1</span><span class="o">+</span><span class="n">ep1</span><span class="p">)</span>

<span class="n">wp_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">30</span> <span class="p">)),</span><span class="n">cont</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>

<span class="c1">#Clase e</span>
<span class="n">x1</span><span class="o">=</span><span class="n">ep1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">ep1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">ep</span><span class="o">-</span><span class="n">ep1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ap</span><span class="o">+</span><span class="n">bp</span><span class="o">+</span><span class="n">cp</span><span class="o">+</span><span class="n">dp</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ap1</span><span class="o">+</span><span class="n">bp1</span><span class="o">+</span><span class="n">cp1</span><span class="o">+</span><span class="n">dp1</span><span class="p">)</span>

<span class="n">wp_e</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_e</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">30</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">pendiente_c</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Se procede a imprimir cada uno de los <span class="math notranslate nohighlight">\(W^+\)</span> y <span class="math notranslate nohighlight">\(W^-\)</span> para detectar valores infinitos que se obtienen de logaritmos de 0, es decir que provienen de clases donde algunos de los numeradores (x1, x2, x3, o x4) es 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">wp_a</span><span class="p">,</span> <span class="n">wn_a</span><span class="p">,</span> <span class="n">wp_b</span><span class="p">,</span> <span class="n">wn_b</span><span class="p">,</span> <span class="n">wp_c</span><span class="p">,</span> <span class="n">wn_c</span><span class="p">,</span> <span class="n">wp_d</span><span class="p">,</span> <span class="n">wn_d</span><span class="p">,</span> <span class="n">wp_e</span><span class="p">,</span> <span class="n">wn_e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.9978126337233664 0.05293079554963469 -0.8269249184231674 0.09637540215921472 -0.190531748869874 0.0740267315295358 0.06871512729071115 -0.015040700202127994 0.45570855845755603 -0.2969812410286435
</pre></div>
</div>
</div>
</div>
<p>A continuación se presenta el mapa de pendiente reclasificado por el Contraste (C)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pendiente_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pendiente_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-2.0507433  -0.9233003   0.08375583  0.7526898          nan]
</pre></div>
</div>
<img alt="_images/08_estadistico_51_1.png" src="_images/08_estadistico_51_1.png" />
</div>
</div>
<p>Este mismo procedimiento se realiza para la variable <em>aspecto</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Clase a</span>
<span class="n">x1</span><span class="o">=</span><span class="n">aa1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">aa1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">aa</span><span class="o">-</span><span class="n">aa1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ba</span><span class="o">+</span><span class="n">ca</span><span class="o">+</span><span class="n">da</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ba1</span><span class="o">+</span><span class="n">ca1</span><span class="o">+</span><span class="n">da1</span><span class="p">)</span>

<span class="n">wp_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">aspecto</span><span class="o">&lt;</span><span class="mi">90</span> <span class="p">)),</span><span class="n">cont</span><span class="p">,</span><span class="n">aspecto</span> <span class="p">)</span>

<span class="c1">#Clase b</span>
<span class="n">x1</span><span class="o">=</span><span class="n">ba1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">ba1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">ba</span><span class="o">-</span><span class="n">ba1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">aa</span><span class="o">+</span><span class="n">ca</span><span class="o">+</span><span class="n">da</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">aa1</span><span class="o">+</span><span class="n">ca1</span><span class="o">+</span><span class="n">da1</span><span class="p">)</span>

<span class="n">wp_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">90</span><span class="p">,</span> <span class="n">aspecto_c</span><span class="o">&lt;</span><span class="mi">180</span> <span class="p">)),</span><span class="n">cont</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>

<span class="c1">#Clase c</span>
<span class="n">x1</span><span class="o">=</span><span class="n">ca1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">ca1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">ca</span><span class="o">-</span><span class="n">ca1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">aa</span><span class="o">+</span><span class="n">ba</span><span class="o">+</span><span class="n">da</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">aa1</span><span class="o">+</span><span class="n">ba1</span><span class="o">+</span><span class="n">da1</span><span class="p">)</span>

<span class="n">wp_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">180</span><span class="p">,</span> <span class="n">aspecto_c</span><span class="o">&lt;</span><span class="mi">270</span> <span class="p">)),</span><span class="n">cont</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>

<span class="c1">#Clase d</span>
<span class="n">x1</span><span class="o">=</span><span class="n">da1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">da1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">da</span><span class="o">-</span><span class="n">da1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">aa</span><span class="o">+</span><span class="n">ba</span><span class="o">+</span><span class="n">ca</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">aa1</span><span class="o">+</span><span class="n">ba1</span><span class="o">+</span><span class="n">ca1</span><span class="p">)</span>

<span class="n">wp_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">270</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">wp_a</span><span class="p">,</span> <span class="n">wn_a</span><span class="p">,</span> <span class="n">wp_b</span><span class="p">,</span> <span class="n">wn_b</span><span class="p">,</span> <span class="n">wp_c</span><span class="p">,</span> <span class="n">wn_c</span><span class="p">,</span> <span class="n">wp_d</span><span class="p">,</span> <span class="n">wn_d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.006945600406864839 -0.0013894983310093806 0.5625413905302987 -0.13237052720363568 -0.15218757915959064 0.06932826692215219 -0.18494286273071125 0.08914131784141605
</pre></div>
</div>
</div>
</div>
<p>A continuación se presenta el mapa de aspecto reclasificado por el Contraste (C)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aspecto_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">aspecto_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-6.975576   -1.         -0.6254262  -0.29615796  2.4018128          nan]
</pre></div>
</div>
<img alt="_images/08_estadistico_56_1.png" src="_images/08_estadistico_56_1.png" />
</div>
</div>
<p>En el método <em>Peso de la evidencia</em> se debe tener en cuenta que las clases que no presentan movimientos en masa generan un matemático, ya que no se puede estimar el logaritmo natural de cero. Por lo tanto, se debe proceder a esas clases qdoden se obtuvo cero celdas asignarles un valor de 1, de tal forma que se pueda ejecutar el cálculo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bg1</span><span class="o">=</span><span class="n">cg1</span><span class="o">=</span><span class="n">eg1</span><span class="o">=</span><span class="n">jg1</span><span class="o">=</span><span class="mi">1</span>   <span class="c1">#clases que obtuvieron 0 celdas con movimientos en masa</span>

<span class="c1">#Clase a</span>
<span class="n">x1</span><span class="o">=</span><span class="n">ag1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">ag1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">ag</span><span class="o">-</span><span class="n">ag1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">bg</span><span class="o">+</span><span class="n">cg</span><span class="o">+</span><span class="n">dg</span><span class="o">+</span><span class="n">eg</span><span class="o">+</span><span class="n">fg</span><span class="o">+</span><span class="n">gg</span><span class="o">+</span><span class="n">hg</span><span class="o">+</span><span class="n">ig</span><span class="o">+</span><span class="n">jg</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">bg1</span><span class="o">+</span><span class="n">cg1</span><span class="o">+</span><span class="n">dg1</span><span class="o">+</span><span class="n">eg1</span><span class="o">+</span><span class="n">fg1</span><span class="o">+</span><span class="n">gg1</span><span class="o">+</span><span class="n">hg1</span><span class="o">+</span><span class="n">ig1</span><span class="o">+</span><span class="n">jg1</span><span class="p">)</span>

<span class="n">wp_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">geologia</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia</span><span class="p">)</span>

<span class="c1">#Clase b</span>
<span class="n">x1</span><span class="o">=</span><span class="n">bg1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">bg1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">bg</span><span class="o">-</span><span class="n">bg1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ag</span><span class="o">+</span><span class="n">cg</span><span class="o">+</span><span class="n">dg</span><span class="o">+</span><span class="n">eg</span><span class="o">+</span><span class="n">fg</span><span class="o">+</span><span class="n">gg</span><span class="o">+</span><span class="n">hg</span><span class="o">+</span><span class="n">ig</span><span class="o">+</span><span class="n">jg</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ag1</span><span class="o">+</span><span class="n">cg1</span><span class="o">+</span><span class="n">dg1</span><span class="o">+</span><span class="n">eg1</span><span class="o">+</span><span class="n">fg1</span><span class="o">+</span><span class="n">gg1</span><span class="o">+</span><span class="n">hg1</span><span class="o">+</span><span class="n">ig1</span><span class="o">+</span><span class="n">jg1</span><span class="p">)</span>

<span class="n">wp_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">4</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase c</span>
<span class="n">x1</span><span class="o">=</span><span class="n">cg1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">cg1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">cg</span><span class="o">-</span><span class="n">cg1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ag</span><span class="o">+</span><span class="n">bg</span><span class="o">+</span><span class="n">dg</span><span class="o">+</span><span class="n">eg</span><span class="o">+</span><span class="n">fg</span><span class="o">+</span><span class="n">gg</span><span class="o">+</span><span class="n">hg</span><span class="o">+</span><span class="n">ig</span><span class="o">+</span><span class="n">jg</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ag1</span><span class="o">+</span><span class="n">bg1</span><span class="o">+</span><span class="n">dg1</span><span class="o">+</span><span class="n">eg1</span><span class="o">+</span><span class="n">fg1</span><span class="o">+</span><span class="n">gg1</span><span class="o">+</span><span class="n">hg1</span><span class="o">+</span><span class="n">ig1</span><span class="o">+</span><span class="n">jg1</span><span class="p">)</span>

<span class="n">wp_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">6</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase d</span>
<span class="n">x1</span><span class="o">=</span><span class="n">dg1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">dg1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">dg</span><span class="o">-</span><span class="n">dg1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ag</span><span class="o">+</span><span class="n">bg</span><span class="o">+</span><span class="n">cg</span><span class="o">+</span><span class="n">eg</span><span class="o">+</span><span class="n">fg</span><span class="o">+</span><span class="n">gg</span><span class="o">+</span><span class="n">hg</span><span class="o">+</span><span class="n">ig</span><span class="o">+</span><span class="n">jg</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ag1</span><span class="o">+</span><span class="n">bg1</span><span class="o">+</span><span class="n">cg1</span><span class="o">+</span><span class="n">eg1</span><span class="o">+</span><span class="n">fg1</span><span class="o">+</span><span class="n">gg1</span><span class="o">+</span><span class="n">hg1</span><span class="o">+</span><span class="n">ig1</span><span class="o">+</span><span class="n">jg1</span><span class="p">)</span>

<span class="n">wp_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">8</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase e</span>
<span class="n">x1</span><span class="o">=</span><span class="n">eg1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">eg1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">eg</span><span class="o">-</span><span class="n">eg1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ag</span><span class="o">+</span><span class="n">bg</span><span class="o">+</span><span class="n">cg</span><span class="o">+</span><span class="n">dg</span><span class="o">+</span><span class="n">fg</span><span class="o">+</span><span class="n">gg</span><span class="o">+</span><span class="n">hg</span><span class="o">+</span><span class="n">ig</span><span class="o">+</span><span class="n">jg</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ag1</span><span class="o">+</span><span class="n">bg1</span><span class="o">+</span><span class="n">cg1</span><span class="o">+</span><span class="n">dg1</span><span class="o">+</span><span class="n">fg1</span><span class="o">+</span><span class="n">gg1</span><span class="o">+</span><span class="n">hg1</span><span class="o">+</span><span class="n">ig1</span><span class="o">+</span><span class="n">jg1</span><span class="p">)</span>

<span class="n">wp_e</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_e</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">9</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase f</span>
<span class="n">x1</span><span class="o">=</span><span class="n">fg1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">fg1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">fg</span><span class="o">-</span><span class="n">fg1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ag</span><span class="o">+</span><span class="n">bg</span><span class="o">+</span><span class="n">cg</span><span class="o">+</span><span class="n">dg</span><span class="o">+</span><span class="n">eg</span><span class="o">+</span><span class="n">gg</span><span class="o">+</span><span class="n">hg</span><span class="o">+</span><span class="n">ig</span><span class="o">+</span><span class="n">jg</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ag1</span><span class="o">+</span><span class="n">bg1</span><span class="o">+</span><span class="n">cg1</span><span class="o">+</span><span class="n">dg1</span><span class="o">+</span><span class="n">eg1</span><span class="o">+</span><span class="n">gg1</span><span class="o">+</span><span class="n">hg1</span><span class="o">+</span><span class="n">ig1</span><span class="o">+</span><span class="n">jg1</span><span class="p">)</span>

<span class="n">wp_f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">10</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase g</span>
<span class="n">x1</span><span class="o">=</span><span class="n">gg1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">gg1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">gg</span><span class="o">-</span><span class="n">gg1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ag</span><span class="o">+</span><span class="n">bg</span><span class="o">+</span><span class="n">cg</span><span class="o">+</span><span class="n">dg</span><span class="o">+</span><span class="n">fg</span><span class="o">+</span><span class="n">eg</span><span class="o">+</span><span class="n">hg</span><span class="o">+</span><span class="n">ig</span><span class="o">+</span><span class="n">jg</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ag1</span><span class="o">+</span><span class="n">bg1</span><span class="o">+</span><span class="n">cg1</span><span class="o">+</span><span class="n">dg1</span><span class="o">+</span><span class="n">fg1</span><span class="o">+</span><span class="n">eg1</span><span class="o">+</span><span class="n">hg1</span><span class="o">+</span><span class="n">ig1</span><span class="o">+</span><span class="n">jg1</span><span class="p">)</span>

<span class="n">wp_g</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_g</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">11</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase h</span>
<span class="n">x1</span><span class="o">=</span><span class="n">hg1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">hg1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">hg</span><span class="o">-</span><span class="n">hg1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ag</span><span class="o">+</span><span class="n">bg</span><span class="o">+</span><span class="n">cg</span><span class="o">+</span><span class="n">dg</span><span class="o">+</span><span class="n">fg</span><span class="o">+</span><span class="n">gg</span><span class="o">+</span><span class="n">eg</span><span class="o">+</span><span class="n">ig</span><span class="o">+</span><span class="n">jg</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ag1</span><span class="o">+</span><span class="n">bg1</span><span class="o">+</span><span class="n">cg1</span><span class="o">+</span><span class="n">dg1</span><span class="o">+</span><span class="n">fg1</span><span class="o">+</span><span class="n">gg1</span><span class="o">+</span><span class="n">eg1</span><span class="o">+</span><span class="n">ig1</span><span class="o">+</span><span class="n">jg1</span><span class="p">)</span>

<span class="n">wp_h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">14</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase i</span>
<span class="n">x1</span><span class="o">=</span><span class="n">ig1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">ig1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">ig</span><span class="o">-</span><span class="n">ig1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ag</span><span class="o">+</span><span class="n">bg</span><span class="o">+</span><span class="n">cg</span><span class="o">+</span><span class="n">dg</span><span class="o">+</span><span class="n">fg</span><span class="o">+</span><span class="n">gg</span><span class="o">+</span><span class="n">hg</span><span class="o">+</span><span class="n">eg</span><span class="o">+</span><span class="n">jg</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ag1</span><span class="o">+</span><span class="n">bg1</span><span class="o">+</span><span class="n">cg1</span><span class="o">+</span><span class="n">dg1</span><span class="o">+</span><span class="n">fg1</span><span class="o">+</span><span class="n">gg1</span><span class="o">+</span><span class="n">hg1</span><span class="o">+</span><span class="n">eg1</span><span class="o">+</span><span class="n">jg1</span><span class="p">)</span>

<span class="n">wp_i</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_i</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">15</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase j</span>
<span class="n">x1</span><span class="o">=</span><span class="n">jg1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">jg1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">jg</span><span class="o">-</span><span class="n">jg1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">ag</span><span class="o">+</span><span class="n">bg</span><span class="o">+</span><span class="n">cg</span><span class="o">+</span><span class="n">dg</span><span class="o">+</span><span class="n">fg</span><span class="o">+</span><span class="n">gg</span><span class="o">+</span><span class="n">hg</span><span class="o">+</span><span class="n">eg</span><span class="o">+</span><span class="n">ig</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">ag1</span><span class="o">+</span><span class="n">bg1</span><span class="o">+</span><span class="n">cg1</span><span class="o">+</span><span class="n">dg1</span><span class="o">+</span><span class="n">fg1</span><span class="o">+</span><span class="n">gg1</span><span class="o">+</span><span class="n">hg1</span><span class="o">+</span><span class="n">eg1</span><span class="o">+</span><span class="n">ig1</span><span class="p">)</span>

<span class="n">wp_j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">16</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">wp_a</span><span class="p">,</span> <span class="n">wn_a</span><span class="p">,</span> <span class="n">wp_b</span><span class="p">,</span> <span class="n">wn_b</span><span class="p">,</span> <span class="n">wp_c</span><span class="p">,</span> <span class="n">wn_c</span><span class="p">,</span> <span class="n">wp_d</span><span class="p">,</span> <span class="n">wn_d</span><span class="p">,</span> <span class="n">wp_e</span><span class="p">,</span> <span class="n">wn_e</span><span class="p">,</span> <span class="n">wp_f</span><span class="p">,</span> <span class="n">wn_f</span><span class="p">,</span> <span class="n">wp_g</span><span class="p">,</span> <span class="n">wn_g</span><span class="p">,</span> <span class="n">wp_h</span><span class="p">,</span> <span class="n">wn_h</span><span class="p">,</span> <span class="n">wp_i</span><span class="p">,</span> <span class="n">wn_i</span><span class="p">,</span> <span class="n">wp_j</span><span class="p">,</span> <span class="n">wn_j</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3719972196859115 -0.1727805096556783 1.2061496660464985 -0.0004326749733077856 -1.6957296987011459 0.002752779757529654 0.5336837785798685 -0.026280284312496238 -4.206160493471516 0.041683506509891124 0.07619539243600662 -0.0019984389181064706 0.4648947478986488 -0.02879076462367898 -0.2203550895609917 0.22972367754746886 1.3791739176961686 -0.006034509849750083 -3.4998350037515005 0.02003254146609238
</pre></div>
</div>
</div>
</div>
<p>Para este caso de la variable <em>geologia</em> se obtienen valores de 0 para las clases b, c, e y j. Por lo tanto se debe asignar valores de 1 y volver a correr el código.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">geologia_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">geologia_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-4.247844   -3.51986755 -1.69848248 -0.45007877  0.07819383  0.49368551
  0.54477773  0.55996406  1.20658234  1.38520843         nan]
</pre></div>
</div>
<img alt="_images/08_estadistico_61_1.png" src="_images/08_estadistico_61_1.png" />
</div>
</div>
<p>Finalmente se calcula el Indice de Susceptibildiad (IS), el cual corresponde a la suma de los mapas reclasificados con el valor del Contraste, de la siguiente forma.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS</span><span class="o">=</span><span class="n">pendiente_c</span><span class="o">+</span><span class="n">aspecto_c</span><span class="o">+</span><span class="n">geologia_c</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">IS</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08_estadistico_63_0.png" src="_images/08_estadistico_63_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="evidential-belief-funtion-ebf">
<h3><em>Evidential Belief Funtion</em> (EBF)<a class="headerlink" href="#evidential-belief-funtion-ebf" title="Permalink to this headline">¶</a></h3>
<p>El modelo EBF (Dempster - Shafer) consiste en el grado de <em>Belief</em> (Bel), <em>Disbelief</em> (Dis), <em>Uncertainty</em> (Unc) y <em>Plausibility</em> (Pls), con valores entre 0 y 1. Bels y Pls representan el límite de probabilidad Bayesiana inferior y superior. Mientras que, Pls es mayor o igual que Bel, y Unc es la diferencia entre ellos, indicando la incertidumbre del resultado.</p>
<p><span class="math notranslate nohighlight">\(Wc_{ij}L=\frac{N(c \cap L)/N(c)}{N(L)-N(c \cap L)/N(S)-N(c)}\)</span></p>
<p><span class="math notranslate nohighlight">\(Belc_{ij}=\frac{Wc_{ij}L}{\sum{Wc_{ij}L}}\)</span></p>
<p><span class="math notranslate nohighlight">\(Wc_{ij} \bar L=\frac{N(c)-N(c \cap L)/N(c)}{N(S)-N(L)-N(c)-N(c \cap L)/N(S)-N(c)}\)</span></p>
<p><span class="math notranslate nohighlight">\(Disc_{ij}=\frac{Wc_{ij} \bar L}{\sum{Wc_{ij} \bar L}}\)</span></p>
<p><span class="math notranslate nohighlight">\(Uncc_{ij}=1-Belc_{ij} - Disc_{ij}\)</span></p>
<div class="figure align-default" id="ebf">
<a class="reference internal image-reference" href="https://www.researchgate.net/profile/Hossein-Nazmfar-2/publication/234059633/figure/fig5/AS:637397922508801&#64;1528978915684/Schematic-relationships-of-evidential-belief-functions-Althuwaynee-et-al-2012.png"><img alt="ebf" src="https://www.researchgate.net/profile/Hossein-Nazmfar-2/publication/234059633/figure/fig5/AS:637397922508801&#64;1528978915684/Schematic-relationships-of-evidential-belief-functions-Althuwaynee-et-al-2012.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 34 </span><span class="caption-text">Método <em>Evidential Belief Funtion</em>.</span><a class="headerlink" href="#ebf" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="ebf1">
<a class="reference internal image-reference" href="https://i.pinimg.com/564x/4c/90/c3/4c90c30f26e6385e74bb00899a4f7110.jpg"><img alt="ebf1" src="https://i.pinimg.com/564x/4c/90/c3/4c90c30f26e6385e74bb00899a4f7110.jpg" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 35 </span><span class="caption-text">Ejemplo del cálculo de <em>Evidential Belief Funtion</em>.</span><a class="headerlink" href="#ebf1" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="id3">
<h4><em>Python</em><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>Para calcular el <em>Belief</em> de las 5 clases de la variable <em>pendiente</em> se utiliza:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">ap1</span><span class="o">/</span><span class="n">ap</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">ap1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">ap</span><span class="p">))</span>
<span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">bp1</span><span class="o">/</span><span class="n">bp</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">bp1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">bp</span><span class="p">))</span>
<span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="n">cp1</span><span class="o">/</span><span class="n">cp</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">cp1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">cp</span><span class="p">))</span>
<span class="n">d</span><span class="o">=</span><span class="p">(</span><span class="n">dp1</span><span class="o">/</span><span class="n">dp</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">dp1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">dp</span><span class="p">))</span>
<span class="n">e</span><span class="o">=</span><span class="p">(</span><span class="n">ep1</span><span class="o">/</span><span class="n">ep</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">ep1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">ep</span><span class="p">))</span>

<span class="n">b_a</span><span class="o">=</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">b_b</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">b_c</span><span class="o">=</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">b_d</span><span class="o">=</span><span class="n">d</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">b_e</span><span class="o">=</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Belief:&quot;</span><span class="p">,</span> <span class="n">b_a</span><span class="p">,</span> <span class="n">b_b</span><span class="p">,</span> <span class="n">b_c</span><span class="p">,</span> <span class="n">b_d</span><span class="p">,</span> <span class="n">b_e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Belief: 0.028636888599459454 0.08836979630596908 0.17057727386806315 0.24158277681574458 0.4708332644107637
</pre></div>
</div>
</div>
</div>
<p>El <em>Disbelief</em> para cada una de las clases de la variable <em>pendiente</em> se calcula de la siguiente forma:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="p">((</span><span class="n">ap</span><span class="o">-</span><span class="n">ap1</span><span class="p">)</span><span class="o">/</span><span class="n">ap</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">ap</span><span class="o">-</span><span class="n">ap1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">ap</span><span class="p">))</span>
<span class="n">b</span><span class="o">=</span><span class="p">((</span><span class="n">bp</span><span class="o">-</span><span class="n">bp1</span><span class="p">)</span><span class="o">/</span><span class="n">bp</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">bp</span><span class="o">-</span><span class="n">bp1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">bp</span><span class="p">))</span>
<span class="n">c</span><span class="o">=</span><span class="p">((</span><span class="n">cp</span><span class="o">-</span><span class="n">cp1</span><span class="p">)</span><span class="o">/</span><span class="n">cp</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">cp</span><span class="o">-</span><span class="n">cp1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">cp</span><span class="p">))</span>
<span class="n">d</span><span class="o">=</span><span class="p">((</span><span class="n">dp</span><span class="o">-</span><span class="n">dp1</span><span class="p">)</span><span class="o">/</span><span class="n">dp</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">dp</span><span class="o">-</span><span class="n">dp1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">dp</span><span class="p">))</span>
<span class="n">e</span><span class="o">=</span><span class="p">((</span><span class="n">ep</span><span class="o">-</span><span class="n">ep1</span><span class="p">)</span><span class="o">/</span><span class="n">ep</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">ep</span><span class="o">-</span><span class="n">ep1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">ep</span><span class="p">))</span>

<span class="n">d_a</span><span class="o">=</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">d_b</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">d_c</span><span class="o">=</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">d_d</span><span class="o">=</span><span class="n">d</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>
<span class="n">d_e</span><span class="o">=</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Disbelief:&quot;</span><span class="p">,</span> <span class="n">d_a</span><span class="p">,</span> <span class="n">d_b</span><span class="p">,</span> <span class="n">d_c</span><span class="p">,</span> <span class="n">d_d</span><span class="p">,</span> <span class="n">d_e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Disbelief: 0.20007080858308765 0.20003011952439112 0.20008850944212533 0.19986765910484464 0.1999429033455513
</pre></div>
</div>
</div>
</div>
<p>Finalmente <em>Uncertainty</em> se obtiene de:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U_a</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_a</span><span class="o">-</span><span class="n">d_a</span>
<span class="n">U_b</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_b</span><span class="o">-</span><span class="n">d_b</span>
<span class="n">U_c</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_c</span><span class="o">-</span><span class="n">d_c</span>
<span class="n">U_d</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_d</span><span class="o">-</span><span class="n">d_d</span>
<span class="n">U_e</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_e</span><span class="o">-</span><span class="n">d_e</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Uncertainty:&quot;</span><span class="p">,</span> <span class="n">U_a</span><span class="p">,</span> <span class="n">U_b</span><span class="p">,</span> <span class="n">U_c</span><span class="p">,</span> <span class="n">U_d</span><span class="p">,</span> <span class="n">U_e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Uncertainty: 0.7712923028174529 0.7116000841696398 0.6293342166898116 0.5585495640794108 0.329223832243685
</pre></div>
</div>
</div>
</div>
<p>En este caso se utilizará el <em>Belief</em> para calcular el mapa de susceptibilidad, por lo tantos se reclasifica la clase con dicho valor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pendiente</span><span class="o">&lt;</span><span class="mi">10</span> <span class="p">)),</span><span class="n">b_a</span><span class="p">,</span><span class="n">pendiente</span> <span class="p">)</span>
<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">20</span> <span class="p">)),</span><span class="n">b_b</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>
<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">30</span> <span class="p">)),</span><span class="n">b_c</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>
<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">35</span> <span class="p">)),</span><span class="n">b_d</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>
<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">35</span><span class="p">,</span><span class="n">b_e</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pendiente_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pendiente_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.02863689 0.08836979 0.17057727 0.24158278 0.47083327        nan]
</pre></div>
</div>
<img alt="_images/08_estadistico_73_1.png" src="_images/08_estadistico_73_1.png" />
</div>
</div>
<p>Se realiza el mismo procedimiento para la variable <em>aspecto</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">aa1</span><span class="o">/</span><span class="n">aa</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">aa1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">aa</span><span class="p">))</span>
<span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">ba1</span><span class="o">/</span><span class="n">ba</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">ba1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">ba</span><span class="p">))</span>
<span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="n">ca1</span><span class="o">/</span><span class="n">ca</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">ca1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">ca</span><span class="p">))</span>
<span class="n">d</span><span class="o">=</span><span class="p">(</span><span class="n">da1</span><span class="o">/</span><span class="n">da</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">da1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">da</span><span class="p">))</span>

<span class="n">b_a</span><span class="o">=</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
<span class="n">b_b</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
<span class="n">b_c</span><span class="o">=</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
<span class="n">b_d</span><span class="o">=</span><span class="n">d</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Belief:&quot;</span><span class="p">,</span> <span class="n">b_a</span><span class="p">,</span> <span class="n">b_b</span><span class="p">,</span> <span class="n">b_c</span><span class="p">,</span> <span class="n">b_d</span><span class="p">)</span>

<span class="n">a</span><span class="o">=</span><span class="p">((</span><span class="n">aa</span><span class="o">-</span><span class="n">aa1</span><span class="p">)</span><span class="o">/</span><span class="n">aa</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">aa</span><span class="o">-</span><span class="n">aa1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">aa</span><span class="p">))</span>
<span class="n">b</span><span class="o">=</span><span class="p">((</span><span class="n">ba</span><span class="o">-</span><span class="n">ba1</span><span class="p">)</span><span class="o">/</span><span class="n">ba</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">ba</span><span class="o">-</span><span class="n">ba1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">ba</span><span class="p">))</span>
<span class="n">c</span><span class="o">=</span><span class="p">((</span><span class="n">ca</span><span class="o">-</span><span class="n">ca1</span><span class="p">)</span><span class="o">/</span><span class="n">ca</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">ca</span><span class="o">-</span><span class="n">ca1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">ca</span><span class="p">))</span>
<span class="n">d</span><span class="o">=</span><span class="p">((</span><span class="n">da</span><span class="o">-</span><span class="n">da1</span><span class="p">)</span><span class="o">/</span><span class="n">da</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">da</span><span class="o">-</span><span class="n">da1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">da</span><span class="p">))</span>

<span class="n">d_a</span><span class="o">=</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
<span class="n">d_b</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
<span class="n">d_c</span><span class="o">=</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>
<span class="n">d_d</span><span class="o">=</span><span class="n">d</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Disbelief:&quot;</span><span class="p">,</span> <span class="n">d_a</span><span class="p">,</span> <span class="n">d_b</span><span class="p">,</span> <span class="n">d_c</span><span class="p">,</span> <span class="n">d_d</span><span class="p">)</span>

<span class="n">U_a</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_a</span><span class="o">-</span><span class="n">d_a</span>
<span class="n">U_b</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_b</span><span class="o">-</span><span class="n">d_b</span>
<span class="n">U_c</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_c</span><span class="o">-</span><span class="n">d_c</span>
<span class="n">U_d</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_d</span><span class="o">-</span><span class="n">d_d</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Uncertainty:&quot;</span><span class="p">,</span> <span class="n">U_a</span><span class="p">,</span> <span class="n">U_b</span><span class="p">,</span> <span class="n">U_c</span><span class="p">,</span> <span class="n">U_d</span><span class="p">)</span>

<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">aspecto</span><span class="o">&lt;</span><span class="mi">90</span> <span class="p">)),</span><span class="n">b_a</span><span class="p">,</span><span class="n">aspecto</span> <span class="p">)</span>
<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">90</span><span class="p">,</span> <span class="n">aspecto_c</span><span class="o">&lt;</span><span class="mi">180</span> <span class="p">)),</span><span class="n">b_b</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>
<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">180</span><span class="p">,</span> <span class="n">aspecto_c</span><span class="o">&lt;</span><span class="mi">270</span> <span class="p">)),</span><span class="n">b_c</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>
<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">270</span><span class="p">,</span><span class="n">b_d</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aspecto_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">aspecto_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Belief: 0.22059904091496013 0.4376299292348657 0.17536859361505716 0.16640243623511694
Disbelief: 0.2499120549717284 0.2496030526973982 0.25022155993041695 0.25026333240045645
Uncertainty: 0.5294889041133115 0.31276701806773605 0.5744098464545259 0.5833342313644265
[-1.          0.16640243  0.17536859  0.22059904  0.43762994         nan]
</pre></div>
</div>
<img alt="_images/08_estadistico_75_1.png" src="_images/08_estadistico_75_1.png" />
</div>
</div>
<p>Para la variable <em>geologia</em> se desarrolla de la siguiente forma:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">ag1</span><span class="o">/</span><span class="n">ag</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">ag1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">ag</span><span class="p">))</span>
<span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">bg1</span><span class="o">/</span><span class="n">bg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">bg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">bg</span><span class="p">))</span>
<span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="n">cg1</span><span class="o">/</span><span class="n">cg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">cg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">cg</span><span class="p">))</span>
<span class="n">d</span><span class="o">=</span><span class="p">(</span><span class="n">dg1</span><span class="o">/</span><span class="n">dg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">dg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">dg</span><span class="p">))</span>
<span class="n">e</span><span class="o">=</span><span class="p">(</span><span class="n">eg1</span><span class="o">/</span><span class="n">eg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">eg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">eg</span><span class="p">))</span>
<span class="n">f</span><span class="o">=</span><span class="p">(</span><span class="n">fg1</span><span class="o">/</span><span class="n">fg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">fg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">fg</span><span class="p">))</span>
<span class="n">g</span><span class="o">=</span><span class="p">(</span><span class="n">gg1</span><span class="o">/</span><span class="n">gg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">gg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">gg</span><span class="p">))</span>
<span class="n">h</span><span class="o">=</span><span class="p">(</span><span class="n">hg1</span><span class="o">/</span><span class="n">hg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">hg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">hg</span><span class="p">))</span>
<span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="n">ig1</span><span class="o">/</span><span class="n">ig</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">ig1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">ig</span><span class="p">))</span>
<span class="n">j</span><span class="o">=</span><span class="p">(</span><span class="n">jg1</span><span class="o">/</span><span class="n">jg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total1</span><span class="o">-</span><span class="n">jg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">jg</span><span class="p">))</span>


<span class="n">b_a</span><span class="o">=</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">b_b</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">b_c</span><span class="o">=</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">b_d</span><span class="o">=</span><span class="n">d</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">b_e</span><span class="o">=</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">b_f</span><span class="o">=</span><span class="n">f</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">b_g</span><span class="o">=</span><span class="n">g</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">b_h</span><span class="o">=</span><span class="n">h</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">b_i</span><span class="o">=</span><span class="n">i</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">b_j</span><span class="o">=</span><span class="n">j</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Belief:&quot;</span><span class="p">,</span> <span class="n">b_a</span><span class="p">,</span> <span class="n">b_b</span><span class="p">,</span> <span class="n">b_c</span><span class="p">,</span> <span class="n">b_d</span><span class="p">,</span> <span class="n">b_e</span><span class="p">,</span> <span class="n">b_f</span><span class="p">,</span> <span class="n">b_g</span><span class="p">,</span> <span class="n">b_h</span><span class="p">,</span> <span class="n">b_i</span><span class="p">,</span> <span class="n">b_j</span><span class="p">)</span>

<span class="n">a</span><span class="o">=</span><span class="p">((</span><span class="n">ag</span><span class="o">-</span><span class="n">ag1</span><span class="p">)</span><span class="o">/</span><span class="n">ag</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">ag</span><span class="o">-</span><span class="n">ag1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">ag</span><span class="p">))</span>
<span class="n">b</span><span class="o">=</span><span class="p">((</span><span class="n">bg</span><span class="o">-</span><span class="n">bg1</span><span class="p">)</span><span class="o">/</span><span class="n">bg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">bg</span><span class="o">-</span><span class="n">bg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">bg</span><span class="p">))</span>
<span class="n">c</span><span class="o">=</span><span class="p">((</span><span class="n">cg</span><span class="o">-</span><span class="n">cg1</span><span class="p">)</span><span class="o">/</span><span class="n">cg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">cg</span><span class="o">-</span><span class="n">cg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">cg</span><span class="p">))</span>
<span class="n">d</span><span class="o">=</span><span class="p">((</span><span class="n">dg</span><span class="o">-</span><span class="n">dg1</span><span class="p">)</span><span class="o">/</span><span class="n">dg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">dg</span><span class="o">-</span><span class="n">dg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">dg</span><span class="p">))</span>
<span class="n">e</span><span class="o">=</span><span class="p">((</span><span class="n">eg</span><span class="o">-</span><span class="n">eg1</span><span class="p">)</span><span class="o">/</span><span class="n">eg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">eg</span><span class="o">-</span><span class="n">eg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">eg</span><span class="p">))</span>
<span class="n">f</span><span class="o">=</span><span class="p">((</span><span class="n">fg</span><span class="o">-</span><span class="n">fg1</span><span class="p">)</span><span class="o">/</span><span class="n">fg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">fg</span><span class="o">-</span><span class="n">fg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">fg</span><span class="p">))</span>
<span class="n">g</span><span class="o">=</span><span class="p">((</span><span class="n">gg</span><span class="o">-</span><span class="n">gg1</span><span class="p">)</span><span class="o">/</span><span class="n">gg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">gg</span><span class="o">-</span><span class="n">gg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">gg</span><span class="p">))</span>
<span class="n">h</span><span class="o">=</span><span class="p">((</span><span class="n">hg</span><span class="o">-</span><span class="n">hg1</span><span class="p">)</span><span class="o">/</span><span class="n">hg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">hg</span><span class="o">-</span><span class="n">hg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">hg</span><span class="p">))</span>
<span class="n">i</span><span class="o">=</span><span class="p">((</span><span class="n">ig</span><span class="o">-</span><span class="n">ig1</span><span class="p">)</span><span class="o">/</span><span class="n">ig</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">ig</span><span class="o">-</span><span class="n">ig1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">ig</span><span class="p">))</span>
<span class="n">j</span><span class="o">=</span><span class="p">((</span><span class="n">jg</span><span class="o">-</span><span class="n">jg1</span><span class="p">)</span><span class="o">/</span><span class="n">jg</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">total</span><span class="o">-</span><span class="n">total1</span><span class="o">-</span><span class="n">jg</span><span class="o">-</span><span class="n">jg1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">jg</span><span class="p">))</span>


<span class="n">d_a</span><span class="o">=</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">d_b</span><span class="o">=</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">d_c</span><span class="o">=</span><span class="n">c</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">d_d</span><span class="o">=</span><span class="n">d</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">d_e</span><span class="o">=</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">d_f</span><span class="o">=</span><span class="n">f</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">d_g</span><span class="o">=</span><span class="n">g</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">d_h</span><span class="o">=</span><span class="n">h</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">d_i</span><span class="o">=</span><span class="n">i</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>
<span class="n">d_j</span><span class="o">=</span><span class="n">j</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Disbelief:&quot;</span><span class="p">,</span> <span class="n">d_a</span><span class="p">,</span> <span class="n">d_b</span><span class="p">,</span> <span class="n">d_c</span><span class="p">,</span> <span class="n">d_d</span><span class="p">,</span> <span class="n">d_e</span><span class="p">,</span> <span class="n">d_f</span><span class="p">,</span> <span class="n">d_g</span><span class="p">,</span> <span class="n">d_h</span><span class="p">,</span> <span class="n">d_i</span><span class="p">,</span> <span class="n">d_j</span><span class="p">)</span>

<span class="n">U_a</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_a</span><span class="o">-</span><span class="n">d_a</span>
<span class="n">U_b</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_b</span><span class="o">-</span><span class="n">d_b</span>
<span class="n">U_c</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_c</span><span class="o">-</span><span class="n">d_c</span>
<span class="n">U_d</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_d</span><span class="o">-</span><span class="n">d_d</span>
<span class="n">U_e</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_e</span><span class="o">-</span><span class="n">d_e</span>
<span class="n">U_f</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_f</span><span class="o">-</span><span class="n">d_f</span>
<span class="n">U_g</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_g</span><span class="o">-</span><span class="n">d_g</span>
<span class="n">U_h</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_h</span><span class="o">-</span><span class="n">d_h</span>
<span class="n">U_i</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_i</span><span class="o">-</span><span class="n">d_i</span>
<span class="n">U_j</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">b_j</span><span class="o">-</span><span class="n">d_j</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Uncertainty:&quot;</span><span class="p">,</span> <span class="n">U_a</span><span class="p">,</span> <span class="n">U_b</span><span class="p">,</span> <span class="n">U_c</span><span class="p">,</span> <span class="n">U_d</span><span class="p">,</span> <span class="n">U_e</span><span class="p">,</span> <span class="n">U_f</span><span class="p">,</span> <span class="n">U_g</span><span class="p">,</span> <span class="n">U_h</span><span class="p">,</span> <span class="n">U_i</span><span class="p">,</span> <span class="n">U_j</span><span class="p">)</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="n">b_a</span><span class="p">,</span><span class="n">geologia</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">4</span><span class="p">,</span><span class="n">b_b</span><span class="p">,</span><span class="n">geologia_c</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">6</span><span class="p">,</span><span class="n">b_c</span><span class="p">,</span><span class="n">geologia_c</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">8</span><span class="p">,</span><span class="n">b_d</span><span class="p">,</span><span class="n">geologia_c</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">9</span><span class="p">,</span><span class="n">b_e</span><span class="p">,</span><span class="n">geologia_c</span> <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">10</span><span class="p">,</span><span class="n">b_f</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">11</span><span class="p">,</span><span class="n">b_g</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">14</span><span class="p">,</span><span class="n">b_h</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">15</span><span class="p">,</span><span class="n">b_i</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>
<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">geologia_c</span><span class="o">==</span><span class="mi">16</span><span class="p">,</span><span class="n">b_j</span><span class="p">,</span><span class="n">geologia_c</span>  <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">geologia_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">geologia_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Belief: 0.11993272791080681 0.23185865586455962 0.012764558792757978 0.12179228309911387 0.0009976325032969371 0.0753178650016471 0.11400254469808202 0.04437665002700843 0.27689117676463276 0.0020659053380944732
Disbelief: 0.10008379504116847 0.09959506656154726 0.10015572352634632 0.09990201784339821 0.10019292592535327 0.10000483055392438 0.09992656286467365 0.1004673598751549 0.09948551776136504 0.1001862000470683
Uncertainty: 0.7799834770480247 0.6685462775738931 0.8870797176808958 0.7783056990574879 0.8988094415713498 0.8246773044444285 0.7860708924372444 0.8551559900978367 0.6236233054740022 0.8977478946148372
[0.00099763 0.00206591 0.01276456 0.04437665 0.07531787 0.11400254
 0.11993273 0.12179228 0.23185866 0.27689118        nan]
</pre></div>
</div>
<img alt="_images/08_estadistico_77_1.png" src="_images/08_estadistico_77_1.png" />
</div>
</div>
<p>Con los mapas de cada variable reclasificados de acuerdo con el valor de <em>Belief</em> se procede entonces a sumar todas las variables y obtener el mapa de susceptibilidad:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS</span><span class="o">=</span><span class="n">pendiente_c</span><span class="o">+</span><span class="n">aspecto_c</span><span class="o">+</span><span class="n">geologia_c</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">IS</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08_estadistico_79_0.png" src="_images/08_estadistico_79_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="certainty-factor-cf">
<h3><em>Certainty Factor</em> (CF)<a class="headerlink" href="#certainty-factor-cf" title="Permalink to this headline">¶</a></h3>
<p>El valor de CF varía entre -1 y +1. Un valor positivo significa un incremento en la certidumbre de la ocurrencia de deslizamientos, mientras que un valor negativo corresponde a una reducción en dicha certidumbre. Un valor cercano a 0 significa que la probabilidad priori es muy similar a la probabilidad condicional.</p>
<div class="figure align-default" id="cf">
<a class="reference internal image-reference" href="https://i.pinimg.com/originals/ae/1a/55/ae1a558572dffa10393f414d91a5bf24.jpg"><img alt="cf" src="https://i.pinimg.com/originals/ae/1a/55/ae1a558572dffa10393f414d91a5bf24.jpg" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 36 </span><span class="caption-text">Método de <em>Certainty Factor</em>.</span><a class="headerlink" href="#cf" title="Permalink to this image">¶</a></p>
</div>
<p>Donde PPa es la probabilidad condicional de la ocurrencia de un deslizamiento en la clase a. PPs es la probabilidad priori del número total de deslizamientos en el área.</p>
<div class="section" id="id4">
<h4><em>Python</em><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Los mapas finales los podemos exportar en formato <em>tif</em>, para eso en el siguiente ejemplo se utiliza el mapa de pendientes para extraer las dimensiones de la matriz (mapa) a crear de la zoan de estudio.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meta</span><span class="o">=</span><span class="n">raster</span><span class="o">.</span><span class="n">profile</span>
<span class="n">raster_transform</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;transform&#39;</span><span class="p">]</span>
<span class="n">raster_crs</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;crs&#39;</span><span class="p">]</span>

<span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;Desktop/IS.TIF&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> 
              <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;Gtiff&#39;</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">pendiente</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">width</span><span class="o">=</span><span class="n">pendiente</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span><span class="n">nodata</span><span class="o">=-</span><span class="mi">999</span><span class="p">,</span><span class="n">crs</span><span class="o">=</span><span class="n">raster_crs</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">raster_transform</span><span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">IS</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="multivariados">
<h2>Multivariados<a class="headerlink" href="#multivariados" title="Permalink to this headline">¶</a></h2>
<p>A diferencia de los métodos estadísticos bivariados, que combinan el inventario de movimientos en masa con cada variable por separado, los métodos estadísticos multivariados evalúan la relación combinada entre la variable dependiente (la ocurrencia de movimientos en masa) y todas variables independientes (variables predictoras) en simultanea. Entre estos métodos se encuentra la regresión logística, la cual ha sido el método mas utilizado alrededor del mundo para evaluar la susceptibilidad por movimientos en masa; al igual que el método de análisis discriminante lineal, el cual es el exigido en los estudios de amenaza en los Planes de Ordenación y Manejo de Cuencas (POMCA) en Colombia.</p>
<p>Adicionalmente como parte de los métodos multivariados, con la explosión de la era de los datos, se encuentran disponibles técnicas de aprendizaje automático de máquinas (<em>machine learning</em>), especificamente los métodos supervisados de clasificación binarios, entre los cuales se encuentran regresión logística y análisis discriminante, pero adicionalmente algoritmos como <em>support vector machine</em>, métodos ensamblados tipo <em>bagging</em> como <em>random forest</em>, tipo boosting como <em>XGBoost</em>, y técnicas de <em>deep learning</em> como redes neuronales artificiales.</p>
<div class="figure align-default" id="ml">
<a class="reference internal image-reference" href="https://miro.medium.com/max/477/1*KFQI59Yv7m1f3fwG68KSEA.jpeg"><img alt="ml" src="https://miro.medium.com/max/477/1*KFQI59Yv7m1f3fwG68KSEA.jpeg" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 37 </span><span class="caption-text">Algoritmos utilizados en <em>machine learning</em></span><a class="headerlink" href="#ml" title="Permalink to this image">¶</a></p>
</div>
<p>Existen métodos paramétricos y no-paramétricos. Los modelos paramétricos simplifican el aprendizaje a partir de los datos de entrenamiento, ya que utilizan una función conocida que generalmente corresponde a una combinación lineal de las variables predictoras. Por lo que como resultado siempre se obtiene los coeficientes de la función predeterminada. Estos modelos además de no exigir una gran capacidad computacional, son muy estables sin presentar problemas de varianza. Sin embargo, en muchos casos el problema a modelar no se ajusta a una función lineal, por lo que pueden presentar problemas de ajuste o sesgo. Para estos casos se recomienda el uso de modelos no paramétricos, ya que no asumen ninguna forma previa de la función objetivo, permitiendo aprender en teoría a partir de los datos de entrenamiento cualquier forma de la función. Generalmente no presentan problemas de ajuste o sesgo, pero en su defecto tienden a sobre ajustarse a los datos, generando problemas de varianza ante nuevas observaciones. En este sentido, un buen modelo se soporta en un balance entre el ajuste y la varianza, desafortunadamente mejorar en uno de estos aspectos implica generalmente reducción en el otro.</p>
<p>Entre las limitaciones que presentan los métodos estadísticos multivariados se encuentra que los resultados implican que los movimientos en masa ocurren por la misma combinación de factores a lo largo del área de estudio. Esta generalización ignora el hecho que la ocurrencia de ciertos tipos de movimientos en masa están controlados por ciertos factores de causa que deben ser analizados o investigados individualmente.</p>
<p>A continuación se describen cada uno de los métodos mas comúnes. Inicialmente se describe el método denominado <em>análisis condicional</em>, el cual es el único de los métodos que no se considera una técnica de <em>machine learning</em>. Posteriormente se procederá a presentar los métodos de <em>machine learning</em> utilizados para evaluar la susceptibilidad por movimientos en masa.</p>
<div class="section" id="metodo-de-analisis-condicional">
<h3>Método de análisis condicional<a class="headerlink" href="#metodo-de-analisis-condicional" title="Permalink to this headline">¶</a></h3>
<p>El método de análisis condicional, o también denominado <em>matrix assessment</em> fue desarrollado por {\cite:t}<code class="docutils literal notranslate"><span class="pre">Clerici2002</span></code>, y no requiere asunciones de aleatoriedad del fenómeno bajo análisis. En general es utilizado por su simpleza conceptual y matemática, sin embargo desde el punto de vista procedimental puede ser demandante.</p>
<p>Se fundamente en el uso de la unidad de análisis denominada Unidad de Condiciones Unicas (UCU). El procedimiento es el siguiente: (i) elaborar el mapa de UCU a partir de las variables predictoras seleccionadas, (ii) se cruza el mapa de UCU con el inventario de movimientos en masa, (iii) se calcula para cada UCU el porcentaje de área con movimientos en masa, (iv) finalmente, se clasifican de acuerdo con el porcentaje de área afectada. Ese porcentaje, que corresponde a una densidad relativa, es equivalente a la probabilidad futura de la ocurrencia de movimientos en masa.</p>
<div class="figure align-default" id="metodo-ucu">
<a class="reference internal image-reference" href="https://i.pinimg.com/564x/cc/6d/00/cc6d00fc1e76c817cac53b08377c25b2.jpg"><img alt="metodo ucu" src="https://i.pinimg.com/564x/cc/6d/00/cc6d00fc1e76c817cac53b08377c25b2.jpg" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 38 </span><span class="caption-text">Método de análisis condicional. Tomado de Urquia et al., (2020).</span><a class="headerlink" href="#metodo-ucu" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="regresion-logistica">
<h3>Regresión logística<a class="headerlink" href="#regresion-logistica" title="Permalink to this headline">¶</a></h3>
<p>El método estadístico multivariado denominado regresión logística (RL) estima la relación entre una variable dependiente (la ocurrencia de movimientos en masa) de valores dicotómicos de 0 (no ocurrencia) y 1 (si ocurrencia), con un grupo de variables independientes, en este caso las variables condicionantes del terreno. La ventaja de la RL es que dichas variables predictoras no requieren tener distribución normal y pueden ser discretas o continuas, o una combinación de ambas. La relación de dependencia entre la ocurrencia de movimientos en masa y las variables es expresada cuantitativamente como:</p>
<p><span class="math notranslate nohighlight">\(P(y/x) = \frac{1}{1+e^-z}\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{p(y/x)}{1-p(y/x)} = e^{a+\sum bx}\)</span></p>
<p><span class="math notranslate nohighlight">\(Ln(\frac{p(y/x)}{1-p(y/x)}) = a+\sum bx\)</span></p>
<p>Donde <span class="math notranslate nohighlight">\(P(y/x)\)</span> es la probabilidad de la ocurrencia de movimientos en masa dado <span class="math notranslate nohighlight">\(X\)</span> y se encuentra en el rango de 0 a 1. y z es la siguiente combinación lineal de las variables independientes.</p>
<p><span class="math notranslate nohighlight">\(z=\beta_o+\beta_1X_1+\beta_2X_2+\beta_3X_3+...+\beta_nX_n\)</span></p>
<p>Donde <span class="math notranslate nohighlight">\(\beta_0\)</span> es el intercepto del modelo según el modelo de RL, los valores <span class="math notranslate nohighlight">\(\beta_i\)</span> (i=1,2, 3, n) son los coeficientes de la regresión
logística, es decir, los pesos de las variables, y los valores <span class="math notranslate nohighlight">\(X_i\)</span> (i=1, 2, 3,…, n) son las variables independientes. El modelo final es una RL de la ocurrencia de movimientos en masa (presencia o ausencia) basado en las variables independientes. De acuerdo con esto, a paesar de que el modelo transformado es lineal en las variables, las probabilidades no son lineales.</p>
<div class="figure align-default" id="rl0">
<a class="reference internal image-reference" href="https://i.pinimg.com/564x/3d/61/22/3d6122d2586096e57c33ddce1497be8d.jpg"><img alt="rl0" src="https://i.pinimg.com/564x/3d/61/22/3d6122d2586096e57c33ddce1497be8d.jpg" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 39 </span><span class="caption-text">Función logística.</span><a class="headerlink" href="#rl0" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="rl">
<a class="reference internal image-reference" href="https://i.pinimg.com/564x/59/ce/fe/59cefecb396127fa7252a395c30eb23f.jpg"><img alt="rl" src="https://i.pinimg.com/564x/59/ce/fe/59cefecb396127fa7252a395c30eb23f.jpg" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 40 </span><span class="caption-text">Ejemplo regresión logística.</span><a class="headerlink" href="#rl" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="rl1">
<a class="reference internal image-reference" href="https://i.pinimg.com/564x/61/e3/8f/61e38fb081e8b0638a090514b2550f6b.jpg"><img alt="rl1" src="https://i.pinimg.com/564x/61/e3/8f/61e38fb081e8b0638a090514b2550f6b.jpg" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Fig. 41 </span><span class="caption-text">Ejemplo regresión logística.</span><a class="headerlink" href="#rl1" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="id5">
<h4><em>Python</em><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>A continuación se implementará el método de RL para evaluar la susceptibilidad por movimientos en masa. En este ejemplo sólo se utilizarán tres variables (<em>pendiente</em>, <em>aspecto</em> y <em>geologia</em>).</p>
<p>el primer paso es crear un <em>Dataframe</em> con todas las variables y el inventario. A partir de este <em>Dataframe</em> se construye un vector con la variable y (ocurrencia o no de movimientos en masa), que permitirá entrenar el modelo de <em>RL</em>, y otro <em>Dataframe</em> con solo las variables predictoras.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="n">d</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;inventario&#39;</span><span class="p">:</span><span class="n">inventario_vector_MenM</span><span class="p">,</span><span class="s1">&#39;pendiente&#39;</span><span class="p">:</span><span class="n">pendiente_vector_MenM</span><span class="p">,</span><span class="s1">&#39;aspecto&#39;</span><span class="p">:</span><span class="n">aspecto_vector_MenM</span><span class="p">,</span><span class="s1">&#39;geologia&#39;</span><span class="p">:</span><span class="n">geologia_vector_MenM</span><span class="p">}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">X</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;inventario&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;inventario&#39;</span><span class="p">]</span>
<span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-472c9bb6-9717-46b3-a530-d237ce7355b6">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pendiente</th>
      <th>aspecto</th>
      <th>geologia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10.862183</td>
      <td>208.523560</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12.265345</td>
      <td>207.437332</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12.469252</td>
      <td>202.684647</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>13.148026</td>
      <td>211.619766</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>14.091524</td>
      <td>220.028976</td>
      <td>14.0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-472c9bb6-9717-46b3-a530-d237ce7355b6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-472c9bb6-9717-46b3-a530-d237ce7355b6 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-472c9bb6-9717-46b3-a530-d237ce7355b6');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>Como la variable <em>geologia</em> es categórica, es necesario para RL transformarla a una variable <em>dummy</em>, lo que significa que cada clase de la variable <em>geologia</em> se convierte en una nueva variable categórica binaria.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dummy_geologia</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="s1">&#39;geologia&#39;</span><span class="p">],</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;geo&#39;</span><span class="p">)</span>
<span class="n">column_name</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">column_name</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;geologia&#39;</span><span class="p">)</span>
<span class="n">X1</span><span class="o">=</span><span class="n">X</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dummy_geologia</span><span class="p">)</span>
<span class="n">X1</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-6dcc9e30-5ca5-406e-8edf-dc0b296147b1">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pendiente</th>
      <th>aspecto</th>
      <th>geo_2.0</th>
      <th>geo_4.0</th>
      <th>geo_6.0</th>
      <th>geo_8.0</th>
      <th>geo_9.0</th>
      <th>geo_10.0</th>
      <th>geo_11.0</th>
      <th>geo_14.0</th>
      <th>geo_15.0</th>
      <th>geo_16.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>344</th>
      <td>14.089577</td>
      <td>271.651306</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>385</th>
      <td>33.104115</td>
      <td>169.349625</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>447</th>
      <td>2.074675</td>
      <td>170.422623</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>593</th>
      <td>0.074204</td>
      <td>214.438995</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>633</th>
      <td>11.016130</td>
      <td>194.512238</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-6dcc9e30-5ca5-406e-8edf-dc0b296147b1')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-6dcc9e30-5ca5-406e-8edf-dc0b296147b1 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-6dcc9e30-5ca5-406e-8edf-dc0b296147b1');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>Existen dos librerias que nos permiten resolver este modelo, <em>statsmodels</em> y <em>sklearn</em>. La primera de ellas nos ofrece como ventaja que nos entrega un resumen con los resultados y métricas de desempeño del modelo. Por lo tanto inicialmente utilizaremos esta librería.</p>
<p>Realmente es un procedimiento muy sencillo. Donde importamos la librería, construimos el modelo con la funcion <em>Logit</em> y asignandole la variable <em>y</em> y la matriz con las variables predictoras. Posteriormente, se entrena el modelo con la función <em>fit</em>. Finalmente, se imprime el resultado con la función <em>summary</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="n">model</span><span class="o">=</span><span class="n">sm</span><span class="o">.</span><span class="n">Logit</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">X1</span><span class="p">)</span>
<span class="n">result</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.012661
         Iterations: 35
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/dist-packages/statsmodels/base/model.py:512: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  &quot;Check mle_retvals&quot;, ConvergenceWarning)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                           Logit Regression Results                           
==============================================================================
Dep. Variable:             inventario   No. Observations:               910801
Model:                          Logit   Df Residuals:                   910800
Method:                           MLE   Df Model:                            0
Date:                Sat, 30 Jul 2022   Pseudo R-squ.:                 0.02902
Time:                        15:11:10   Log-Likelihood:                -11532.
converged:                      False   LL-Null:                       -11876.
Covariance Type:            nonrobust   LLR p-value:                       nan
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
pendiente      0.0396      0.002     17.337      0.000       0.035       0.044
aspecto    -5.103e-05      0.000     -0.201      0.841      -0.001       0.000
geo_2.0       -7.2254      0.104    -69.173      0.000      -7.430      -7.021
geo_4.0      -22.2799   3194.061     -0.007      0.994   -6282.524    6237.964
geo_6.0      -24.2261   2081.830     -0.012      0.991   -4104.537    4056.085
geo_8.0       -7.1499      0.133    -53.657      0.000      -7.411      -6.889
geo_9.0      -23.8178    551.897     -0.043      0.966   -1105.516    1057.881
geo_10.0      -7.6123      0.184    -41.348      0.000      -7.973      -7.251
geo_11.0      -7.0040      0.122    -57.204      0.000      -7.244      -6.764
geo_14.0      -7.8179      0.109    -71.659      0.000      -8.032      -7.604
geo_15.0      -5.7754      0.288    -20.022      0.000      -6.341      -5.210
geo_16.0     -22.2074    266.907     -0.083      0.934    -545.335     500.920
==============================================================================
</pre></div>
</div>
</div>
</div>
<p>Hasta este punto con la librería <em>statsmodels</em> tenemos los valores de los coeficientes que acompañanan a cada variable predictora. A partir de esto valore se cosntruye la ecuación de la regresión logistica y se puede entonces obtener el mapa de susceptibilidad para toda la cuenca.</p>
<p>Pero para realziar todo el procedimiento completo, hasta obtener el mapa de susceptibilidad, es recomendable utilizar la librería <em>sklearn</em> que nos brinda funciones para todo esto.</p>
<p>Iniciloamente, se importa la función para RL, y e construye el modelo con los hiperparámetros. En este caso, estamos asignadole un <em>class_weight</em> = balanced para que asigne mas peso a las celdas minoritarias, en este caso las celdas donde y=1. De esta forma RL nos ayuda a resolver el problema de la base de datos original  desbalanceada. El segundo hiperparámetro que utilizamos es el tipo de algoritmo para resolver la RL, en este caso utilizaremos <em>newton-cg</em>, existen otros algoritmos que ofrece a herramienta y que se pueden consultar en <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html">guía de usuario.</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="n">model</span><span class="o">=</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;newton-cg&#39;</span><span class="p">)</span>
<span class="n">model</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LogisticRegression(class_weight=&#39;balanced&#39;, solver=&#39;newton-cg&#39;)
</pre></div>
</div>
</div>
</div>
<p>Luego de tener el modelo construido, se le asignan los datso con la función <em>fit</em>, en este caso, primero la matriz con las variables predictoras, y luego la variable <em>y</em>. De esta forma el modelo se entrena con los datos y se pueden obtener los resultados de los valores de los coeficientes con la función <em>coef_</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 4.4153962e-02 -5.7120993e-05  1.3414711e+00 -2.6784331e-01
  -2.0767705e+00  1.3869253e+00 -4.3369098e+00  9.7137809e-01
   1.4465705e+00  7.3794961e-01  2.6813078e+00 -4.2109256e+00]]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/dist-packages/scipy/optimize/linesearch.py:327: LineSearchWarning: The line search algorithm did not converge
  warn(&#39;The line search algorithm did not converge&#39;, LineSearchWarning)
/usr/local/lib/python3.7/dist-packages/sklearn/utils/optimize.py:203: UserWarning: Line Search failed
  warnings.warn(&quot;Line Search failed&quot;)
</pre></div>
</div>
</div>
</div>
<p>Con el modelo entrenado y guardado en la varible <em>result</em> podemos entonces obtener los valores que predice el modelo para toda la matriz con las variables predictoras. Para eso se utiliza la función <em>predict</em>. Esta función clasifica cada celda como inestable (1) o estable (0).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
<span class="n">y_pred</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0., 0., 0., ..., 0., 0., 0.])
</pre></div>
</div>
</div>
</div>
<p>Sin embargo, tambien se puede obtener los resultados del modelo antes de clasificarlo como (0,1). es decir la probabilidad de cada celda de ser 0 o de ser 1. Para eso se utiliza la función <em>predict_proba</em>. La cual puede ser mas útil para nuestro mapa.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_prob</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
<span class="n">y_prob</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.7619109 , 0.23808908],
       [0.75047874, 0.24952123],
       [0.74873793, 0.25126204],
       ...,
       [0.5873656 , 0.4126344 ],
       [0.6160013 , 0.3839987 ],
       [0.61599934, 0.38400066]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<p>como se puede observar el resultado en este caso, en lugar de ser un vector con la clasificacion de cada celda, es un matriz de dos columnas. Donde la primera columna es la probabilidad de cada celda de ser 0, es decir estable, y la segudna columna la probabilidad de ser 1, es decir inestable. Para nuestro propósito es mas útil obtener la probabilidad de cada celda de ser inestable. Para eso seleccionamos entonces solo la segunda columna de la matriz obtenida.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_probs</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X1</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y_probs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.23808908, 0.24952123, 0.25126204, ..., 0.4126344 , 0.3839987 ,
       0.38400066], dtype=float32)
</pre></div>
</div>
</div>
</div>
<p>Ya tenemos los resultados y la predicción para todas las celdas. Sin embargo esto lo tenemos para un vector que construimos la principio que solo contiene las celdas dentro de la cuenca, es decir eliminó todas las celdas por fuera. Eso nos impide construir nuestra cuenca a partir de este vector.</p>
<p>Una forma de resolver esto se presenta a continuación. Existen muchas formas, seguramente otras mas directas.</p>
<p>Para este caso construiremos entonces un nuevo <em>Dataframe</em>, pero en este caso con el vector completo, sin eliminar las celdas por fuera de la cuenca, y las celdas por fuera de la cuenca, en lugar de tener un valor de NaN les daremos un valor de 0. Las funciones de <em>sklearn</em> no corren cuando encuentra dentro de los valores NaN.</p>
<p>De igual forma, hay que transformar las variables categóricas a variables tipo <em>dummy</em> y en este caso debemos eliminar un anueva columna que se forma con el intercepto y que denomina <em>0.0</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pendiente_vector2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">pendiente_vector</span><span class="p">)</span>
<span class="n">aspecto_vector2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">aspecto_vector</span><span class="p">)</span>
<span class="n">geologia_vector2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="n">geologia_vector</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pendiente&#39;</span><span class="p">:</span><span class="n">pendiente_vector2</span><span class="p">,</span><span class="s1">&#39;aspecto&#39;</span><span class="p">:</span><span class="n">aspecto_vector2</span><span class="p">,</span><span class="s1">&#39;geologia&#39;</span><span class="p">:</span><span class="n">geologia_vector2</span><span class="p">}</span>
<span class="n">x_map</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">dummy_geologia</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">x_map</span><span class="p">[</span><span class="s1">&#39;geologia&#39;</span><span class="p">],</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;geo&#39;</span><span class="p">)</span>
<span class="n">column_name</span><span class="o">=</span><span class="n">x_map</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">column_name</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;geologia&#39;</span><span class="p">)</span>
<span class="n">x_map</span><span class="o">=</span><span class="n">x_map</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dummy_geologia</span><span class="p">)</span>
<span class="n">x_map</span><span class="o">=</span><span class="n">x_map</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;geo_0.0&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x_map</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c2e0cb38-3b55-4557-965d-673cf4097ea9">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pendiente</th>
      <th>aspecto</th>
      <th>geo_2.0</th>
      <th>geo_4.0</th>
      <th>geo_6.0</th>
      <th>geo_8.0</th>
      <th>geo_9.0</th>
      <th>geo_10.0</th>
      <th>geo_11.0</th>
      <th>geo_14.0</th>
      <th>geo_15.0</th>
      <th>geo_16.0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1854705</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1854706</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1854707</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1854708</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1854709</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1854710 rows × 12 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c2e0cb38-3b55-4557-965d-673cf4097ea9')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c2e0cb38-3b55-4557-965d-673cf4097ea9 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c2e0cb38-3b55-4557-965d-673cf4097ea9');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<p>Como se puede observar, tenemos ahora una matriz con todas las variables y con un número mayor de celdas.</p>
<p>Con esta matriz podemos entonces obtener para cada celda la probabilidad que se inestable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">x_map</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Ya lo unico que nos queda es reconstruir a partir de dicho vector la matriz que conforma la cuenca con los valores de susceptibilidad. Para eso utilizaremos como máscara el mapa de pendiente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/edieraristizabal/Libro_cartoGeotecnia/blob/master/data/Pendiente.tif?raw=true&#39;</span><span class="p">)</span>
<span class="n">pendiente</span><span class="o">=</span><span class="n">raster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS</span><span class="o">=</span><span class="n">y_pred</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">pendiente</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">IS</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pendiente</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">IS</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">IS</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08_estadistico_112_0.png" src="_images/08_estadistico_112_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="analisis-discriminante-lineal">
<h3>Análisis discriminante lineal<a class="headerlink" href="#analisis-discriminante-lineal" title="Permalink to this headline">¶</a></h3>
<p>El análisis discriminante lineal (LDA) es una técnica estadística que crea una función capaz de clasificar los fenómenos, teniendo en cuenta una serie de variables discriminadoras y una probabilidad de pertenencia. LDA encuentra combinaciones lineales de variables que mejor “discriminan” las clases de la variable respuesta. LDA supone que las variables predictoras son variables aleatorias continuas normalmente distribuidas y con la misma varianza.</p>
<p>El enfoque de Fisher para LDA es encontrar una combinación lineal de predictores que maximice la matriz de covarianza entre grupos,  relativo a la matriz de covarianza dentro del grupo (intra-grupo). La solución a este problema de optimización es el vector propio correspondiente al valor propio más grande de  <span class="math notranslate nohighlight">\(W^{-1}B\)</span> . Este vector es un discriminante lineal (e.g. una variable). Resolver para la configuración para dos grupos la función discriminante <span class="math notranslate nohighlight">\(S^{-1}(X_1-X_2)\)</span> donde  <span class="math notranslate nohighlight">\(S^{-1}\)</span>  es la inversa de la matriz de covarianza de los datos y  <span class="math notranslate nohighlight">\(X_1\)</span> y <span class="math notranslate nohighlight">\(X_2\)</span> son las medias de cada predictor en los grupos de respuesta 1 y 2. En la práctica, una nueva muestra, <span class="math notranslate nohighlight">\(u\)</span>, se proyecta sobre la función discriminante como  <span class="math notranslate nohighlight">\(uS^{-1}(X_1-X_2)\)</span>, que devuelve una puntuación discriminante. Luego, una nueva muestra se clasifica en el grupo 1 si la muestra está más cerca de la media del grupo 1 que de la media del grupo 2 en la proyección.</p>
<div class="figure align-default" id="lda">
<a class="reference internal image-reference" href="https://1.bp.blogspot.com/-ODry-XJ159E/Vc9ZRXVvnwI/AAAAAAAABuc/FpSIJdTrqK0/s1600/Analisis-Discriminante-001.png"><img alt="lda" src="https://1.bp.blogspot.com/-ODry-XJ159E/Vc9ZRXVvnwI/AAAAAAAABuc/FpSIJdTrqK0/s1600/Analisis-Discriminante-001.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 42 </span><span class="caption-text">Intrepretación geométrica de LDA. Tomado de <a class="reference external" href="https://plepso.blogspot.com/2015/08/analisis-discriminante-de-dos-grupos.html">Plepso</a></span><a class="headerlink" href="#lda" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="id6">
<h4><em>Python</em><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>El procedimiento para todos los métodos de <em>machine learning</em> con <em>sklearn</em> son muy similares. Se importa la librería, se instancia el modelo con los <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.discriminant_analysis.LinearDiscriminantAnalysis.html">hiperparámetros</a> deseados, en este caso vamos a proyectar los datos sobre un nuevo eje (función discriminante), se entrena el modelo, y se predice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.discriminant_analysis</span> <span class="kn">import</span> <span class="n">LinearDiscriminantAnalysis</span>

<span class="n">LDA</span> <span class="o">=</span> <span class="n">LinearDiscriminantAnalysis</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">LDA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LinearDiscriminantAnalysis(n_components=1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LDA</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Para obtener el mapa se realiza la predicción con el <em>Dataframe</em> que tiene todos las celdas, y luego se redimensiona este vector a la matriz que forma la cuenca, utilizando como máscara el mapa de pendiente. Pero para esto debemos contruir un <em>Dataframe</em> con todas las celdas pero que en este caso sin la transformación de la variable <em>geologia</em>. Estos modelos permiten trabajar con variables categóricas sin transformación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pendiente&#39;</span><span class="p">:</span><span class="n">pendiente_vector2</span><span class="p">,</span><span class="s1">&#39;aspecto&#39;</span><span class="p">:</span><span class="n">aspecto_vector2</span><span class="p">,</span><span class="s1">&#39;geologia&#39;</span><span class="p">:</span><span class="n">geologia_vector2</span><span class="p">}</span>
<span class="n">x_map</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">x_map</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-07b4eae5-d1be-4434-8899-199bd6e2e0fa">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pendiente</th>
      <th>aspecto</th>
      <th>geologia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1854705</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1854706</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1854707</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1854708</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1854709</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>1854710 rows × 3 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-07b4eae5-d1be-4434-8899-199bd6e2e0fa')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-07b4eae5-d1be-4434-8899-199bd6e2e0fa button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-07b4eae5-d1be-4434-8899-199bd6e2e0fa');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS</span><span class="o">=</span><span class="n">IS</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">pendiente</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">IS</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pendiente</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">IS</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">IS</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08_estadistico_121_0.png" src="_images/08_estadistico_121_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="support-vector-machine">
<h3><em>Support vector machine</em><a class="headerlink" href="#support-vector-machine" title="Permalink to this headline">¶</a></h3>
<p>SVM es un modelo que representa a los puntos de muestra en el espacio, separando las clases a 2 espacios lo más amplios posibles mediante un hiperplano de separación definido como el vector entre los 2 puntos, de las 2 clases, más cercanos al que se llama vector soporte. Cuando las nuevas muestras se ponen en correspondencia con dicho modelo, en función de los espacios a los que pertenezcan, pueden ser clasificadas a una o la otra clase.</p>
<p>Los vectores de soporte son los puntos que definen el margen máximo de separación del hiperplano que separa las clases. Se llaman vectores, en lugar de puntos, porque estos «puntos» tienen tantos elementos como dimensiones tenga nuestro espacio de entrada. Es decir, estos puntos multi-dimensionales se representan con con vector de n dimensiones.</p>
<div class="figure align-default" id="svm">
<a class="reference internal image-reference" href="https://www.iartificial.net/wp-content/uploads/2019/04/Clasificacion-SVM-768x436.webp"><img alt="svm" src="https://www.iartificial.net/wp-content/uploads/2019/04/Clasificacion-SVM-768x436.webp" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 43 </span><span class="caption-text">Intrepretación geométrica de SVM. Tomado de <a class="reference external" href="https://www.iartificial.net/maquinas-de-vectores-de-soporte-svm/">iartificial.net</a></span><a class="headerlink" href="#svm" title="Permalink to this image">¶</a></p>
</div>
<p>El <em>Maximal Margin Classifier</em> tiene poca aplicación práctica, ya que rara vez se encuentran casos en los que las clases sean perfecta y linealmente separables. De hecho, incluso cumpliéndose estas condiciones ideales, en las que exista un hiperplano capaz de separar perfectamente las observaciones en dos clases, esta aproximación sigue presentando dos inconvenientes:</p>
<ul class="simple">
<li><p>Dado que el hiperplano tiene que separar perfectamente las observaciones, es muy sensible a variaciones en los datos. Incluir una nueva observación puede suponer cambios muy grandes en el hiperplano de separación (poca robustez).</p></li>
<li><p>Que el maximal margin hyperplane se ajuste perfectamente a las observaciones de entrenamiento para separarlas todas correctamente suele conllevar problemas de overfitting.</p></li>
</ul>
<p>Por estas razones, es preferible crear un clasificador basado en un hiperplano que, aunque no separe perfectamente las dos clases, sea más robusto y tenga mayor capacidad predictiva al aplicarlo a nuevas observaciones (menos problemas de overfitting). Esto es exactamente lo que consiguen los clasificadores de vector soporte, también conocidos como soft margin classifiers o Support Vector Classifiers. Para lograrlo, en lugar de buscar el margen de clasificación más ancho posible que consigue que las observaciones estén en el lado correcto del margen; se permite que ciertas observaciones estén en el lado incorrecto del margen o incluso del hiperplano (Tomado de <a class="reference external" href="https://www.cienciadedatos.net/documentos/34_maquinas_de_vector_soporte_support_vector_machines">cienciadedatos.net</a>).</p>
<div class="section" id="id7">
<h4><em>Python</em><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>Similar a lso casos anteriores, se importa la librearía de SVC, y se instancia. En este caso se utlizará un kernel lineal y un valor de regularizacion de 1xE10. Existen otra serie de hiperparámetros para instanciar el modelo que se pueden consultar en la <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html">guía del usuario</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">1E10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Si se utiliza toda la base de datos, los resultados obtenidos clasifican todas las celdas con valores muy bajos. Esto se debe a que se utilizó para el entrenamiento la matriz desbalanceada, es decir con las celdas del <em>si</em> (1) y con todas las celdas del <em>no</em> (0). Lo que genera que el modelo no aprenda adecuadamente a predecir los <em>si</em>, ya que aprende esencialmente el <em>no</em>.</p>
<p>Como este método no tiene un hiperparámetro para manejar esta situación, como RL, entonces debemos remuestrear nuestros datos de entrenamiento de tal forma que se reduzca el desbalance. En este caso utilizaremos el 1% de los <em>no</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">=</span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;inventario&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;inventario&quot;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)]</span>
<span class="n">X_01</span><span class="o">=</span><span class="n">df1</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;inventario&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_01</span><span class="o">=</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;inventario&#39;</span><span class="p">]</span>
<span class="n">df1</span><span class="p">[</span><span class="s1">&#39;inventario&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0    9090
1.0    1620
Name: inventario, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>El proceso a continuación toma un tiempo considerable, de acuerdo con la capacidad computacional o el ambiente de trabajo que esté utilizando (cuantas celdas tiene su base de datos?…entonces paciencia…o remuestree sus datos).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_01</span><span class="p">,</span><span class="n">y_01</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS_01</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS_01</span><span class="o">=</span><span class="n">IS_01</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">pendiente</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">IS_01</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pendiente</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">IS_01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">IS_01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08_estadistico_131_0.png" src="_images/08_estadistico_131_0.png" />
</div>
</div>
<p>Como se puede observar, el modelo ya tiene capacidad para predecir los <em>si</em> (1).</p>
</div>
</div>
<div class="section" id="random-forest">
<h3><em>Random forest</em><a class="headerlink" href="#random-forest" title="Permalink to this headline">¶</a></h3>
<p>Los árboles de decisión tienen la tendencia de sobre-ajustar (overfit). Esto quiere decir que tienden a aprender muy bien los datos de entrenamiento pero su generalización no es tan buena. Una forma de mejorar la generalización de los árboles de decisión es usar regularización. Para mejorar mucho más la capacidad de generalización de los árboles de decisión, deberemos combinar varios árboles.</p>
<p>Un Random Forest es un conjunto (ensemble) de árboles de decisión combinados con bagging. Al usar bagging, lo que en realidad está pasando, es que distintos árboles ven distintas porciones de los datos. Ningún árbol ve todos los datos de entrenamiento. Esto hace que cada árbol se entrene con distintas muestras de datos para un mismo problema. De esta forma, al combinar sus resultados, unos errores se compensan con otros y tenemos una predicción que generaliza mejor (Tomado de <a class="reference external" href="https://www.iartificial.net/random-forest-bosque-aleatorio/">iartificial.net</a>).</p>
<div class="figure align-default" id="rf">
<a class="reference internal image-reference" href="https://www.tibco.com/sites/tibco/files/media_entity/2021-05/random-forest-diagram.svg"><img alt="rf" src="https://www.tibco.com/sites/tibco/files/media_entity/2021-05/random-forest-diagram.svg" width="400px" /></a>
<p class="caption"><span class="caption-number">Fig. 44 </span><span class="caption-text">Intrepretación geométrica de <em>random forest</em>*</span><a class="headerlink" href="#rf" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="id8">
<h4><em>Python</em><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>De forma similar se importa la librearía, y se instancia con los <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html">hiperparámetros</a> deseados. Igualmente se trabajará solo con el 1% de las celdas del <em>si</em> (1)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>

<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_01</span><span class="p">,</span> <span class="n">y_01</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS_01</span><span class="o">=</span><span class="n">rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS_01</span><span class="o">=</span><span class="n">IS_01</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">pendiente</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">IS_01</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pendiente</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">IS_01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">IS_01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08_estadistico_139_0.png" src="_images/08_estadistico_139_0.png" />
</div>
</div>
<p>El modelo de <em>random forest</em> permite obtener la importancia de las variables. A continuación se presenta el código para eso:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.47517109325806123, 0.48043670293880586, 0.04439220380313297]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="redes-neuronales">
<h3>Redes neuronales<a class="headerlink" href="#redes-neuronales" title="Permalink to this headline">¶</a></h3>
<p>Una red neuronal artificial es un grupo interconectado de nodos similar a la vasta red de neuronas en un cerebro biológico. Cada nodo circular representa una neurona artificial y cada flecha representa una conexión desde la salida de una neurona a la entrada de otra.</p>
<div class="figure align-default" id="rna">
<a class="reference internal image-reference" href="https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/Colored_neural_network_es.svg/300px-Colored_neural_network_es.svg.png"><img alt="rna" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/11/Colored_neural_network_es.svg/300px-Colored_neural_network_es.svg.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 45 </span><span class="caption-text">Intrepretación geométrica de redes neuronales. Tomado de <a class="reference external" href="https://es.wikipedia.org/wiki/Red_neuronal_artificial">Wikipedia</a></span><a class="headerlink" href="#rna" title="Permalink to this image">¶</a></p>
</div>
<p>Cada neurona está conectada con otras a través de unos enlaces. En estos enlaces el valor de salida de la neurona anterior es multiplicado por un valor de peso. Estos pesos en los enlaces pueden incrementar o inhibir el estado de activación de las neuronas adyacentes. Del mismo modo, a la salida de la neurona, puede existir una función limitadora o umbral, que modifica el valor resultado o impone un límite que no se debe sobrepasar antes de propagarse a otra neurona. Esta función se conoce como función de activación. Estos sistemas aprenden y se forman a sí mismos, en lugar de ser programados de forma explícita. Para realizar este aprendizaje automático, normalmente, se intenta minimizar una función de pérdida que evalúa la red en su total. Los valores de los pesos de las neuronas se van actualizando buscando reducir el valor de la función de pérdida. Este proceso se realiza mediante la propagación hacia atrás.</p>
<div class="section" id="id9">
<h4><em>Python</em><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>La librearía <em>sklearn</em> permite implementar el <em>Multi-layer Perceptron classifier</em> (MLP). Para redes neuronales mas complejas se deben utilizar otras librearías como TensorFlow. Sin embargo MLP permite un importante número de <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.neural_network.MLPClassifier.html">hiperparámetros</a>, tales como el número de capas escondidas y el número de neuronas en cada una, asi como el número de iteracciones que deseamos realice la RNA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>

<span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>  <span class="c1"># dos capas escondidas, la primera con 5 neuronas y la segunda con dos neuronas</span>
<span class="n">mlp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MLPClassifier(hidden_layer_sizes=(5, 2), max_iter=500)
</pre></div>
</div>
</div>
</div>
<p>Para RNA es importante escalar las variables, para esto utilizamos la función <em>StandarScaler</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_01</span><span class="p">)</span>
<span class="n">X_trans</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_01</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finlamente, se entrena el modelo y se predeci.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mlp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_01</span><span class="p">,</span><span class="n">y_01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MLPClassifier(hidden_layer_sizes=(5, 2), max_iter=500)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS</span><span class="o">=</span><span class="n">mlp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS_01</span><span class="o">=</span><span class="n">IS_01</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">pendiente</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">IS_01</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pendiente</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">IS_01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">IS_01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08_estadistico_151_0.png" src="_images/08_estadistico_151_0.png" />
</div>
</div>
</div>
</div>
</div>
<div class="section" id="referencias">
<h2>Referencias<a class="headerlink" href="#referencias" title="Permalink to this headline">¶</a></h2>
<span class="target" id="id10"></span></div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="07_heuristico.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Métodos basados en el conocimiento</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="09_fisico.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Métodos con base física</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Edier V. Aristizábal G.<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>