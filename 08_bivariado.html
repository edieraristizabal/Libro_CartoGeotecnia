
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Métodos basados en datos &#8212; Cartografía Geotécnica</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Métodos basados en datos -Regresión logística-" href="regresionLogistica.html" />
    <link rel="prev" title="Métodos basados en el conocimiento" href="07_heuristico.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Cartografía Geotécnica</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Cartografía Geotécnica
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="00_introduccion.html">
   Introducción
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01_normatividad.html">
   Amenaza &amp; ordenamiento territorial
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_estadoarte.html">
   Estudios de zonificación de movimientos en masa en el Valle de Aburrá
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_metodos.html">
   Caracterización de movimientos en masa
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_susceptibilidad.html">
   Susceptibilidad y amenaza
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_inventario.html">
   Inventario de movimientos en masa
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_variables.html">
   Selección de variables predictoras
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07_heuristico.html">
   Métodos basados en el conocimiento
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Métodos basados en datos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="regresionLogistica.html">
   Métodos basados en datos -Regresión logística-
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="machinelearning.html">
   Métodos basados en datos -
   <em>
    machine learning
   </em>
   -
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="clasificacion.html">
   Clasificación y zonificación
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fisica.html">
   Métodos con base física
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="evaluacion.html">
   Evaluación del desempeño y capacidad de predicción del modelo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="detonante.html">
   Factores detonantes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="amenaza.html">
   Evaluación de la amenaza
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="flujos.html">
   Movimientos en masa tipo flujos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="roca.html">
   Movimientos en masa en roca
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/08_bivariado.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/edieraristizabal/Libro_cartoGeotecnia"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/edieraristizabal/Libro_cartoGeotecnia/issues/new?title=Issue%20on%20page%20%2F08_bivariado.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/edieraristizabal/Libro_cartoGeotecnia/master?urlpath=tree/docs/08_bivariado.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bivariados">
   Bivariados
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#frequency-ratio-model-likelihood">
     <em>
      Frequency ratio model
     </em>
     (
     <em>
      Likelihood
     </em>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#statistical-index-model">
     <em>
      Statistical index model
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#peso-de-la-evidencia-woe">
     Peso de la evidencia (WoE)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evidential-belief-funtion-ebf">
     <em>
      Evidential Belief Funtion
     </em>
     (EBF)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#certainty-factor-cf">
     <em>
      Certainty Factor
     </em>
     (CF)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python">
   Python
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Métodos basados en datos</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#bivariados">
   Bivariados
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#frequency-ratio-model-likelihood">
     <em>
      Frequency ratio model
     </em>
     (
     <em>
      Likelihood
     </em>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#statistical-index-model">
     <em>
      Statistical index model
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#peso-de-la-evidencia-woe">
     Peso de la evidencia (WoE)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evidential-belief-funtion-ebf">
     <em>
      Evidential Belief Funtion
     </em>
     (EBF)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#certainty-factor-cf">
     <em>
      Certainty Factor
     </em>
     (CF)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python">
   Python
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="metodos-basados-en-datos">
<h1>Métodos basados en datos<a class="headerlink" href="#metodos-basados-en-datos" title="Permalink to this headline">¶</a></h1>
<div class="section" id="bivariados">
<h2>Bivariados<a class="headerlink" href="#bivariados" title="Permalink to this headline">¶</a></h2>
<p>En los métodos bivariados cada mapa factor (geología, pendiente, coberturas, etc) es combinado con el inventario de movimientos en masa, para obtener los pesos de las clases que conforman las variables, basados generalmente en densidad de movimientos en masa. Los métodos estadísticos bivariados son una buena herramienta de aprendizaje para el analista encontrar qué factores o combinación de factores juegan un papel importante en la ocurrencia de movimientos en masa.</p>
<p>Como se mencionó anteriormente, estos métodos están basados en la asociación observada entre la distribución de los movimientos en masa y cada clase de la variable, lo que exige que cada variable sea transforamda a una variable categórica dividida por clases. De esta misma forma los métodos bivariados sólo permiten asignar peso a las clases y no a las variables, por lo que todas las variables tienen una importancia igual sobre la ocurrencia de movimientos en masa. Considerando esta desventaja, es muy común combinar los métodos estadísticos bivariados con métodos heurísticos como AHP para poder asignar peso a las variables.</p>
<p>Existe uan gran cantidad de métodos estadísticos bivariados, los cuales se subdividen esencialmente en métodos basados en la densidad del número de movimientos en masa en cada clase (<em>Frequency ratio</em>, <em>Statistical index</em>), y los métodos basados en el teorema de Bayes (<em>Weight-of-evidence</em>, <em>Evidential belief function</em>,  <em>Certainty factor</em>).</p>
<div class="section" id="frequency-ratio-model-likelihood">
<h3><em>Frequency ratio model</em> (<em>Likelihood</em>)<a class="headerlink" href="#frequency-ratio-model-likelihood" title="Permalink to this headline">¶</a></h3>
<p>Este método, al igual que todos los métodos bivariados, calcula un peso para cada clase en la cual es dividida cada variable. En este caso el peso de la clase n (<span class="math notranslate nohighlight">\(w_n\)</span>) se calcula dividiendo la relación de la ocurrencia de movimientos en masa (<span class="math notranslate nohighlight">\(L_r\)</span>) por la relación del área de la clase (<span class="math notranslate nohighlight">\(A_r\)</span>):</p>
<p><span class="math notranslate nohighlight">\(w_n = \frac{L_r}{A_r}\)</span></p>
<p>Donde <span class="math notranslate nohighlight">\(L_r\)</span> es el porcentaje de movimientos en masa total que contiene la clase <span class="math notranslate nohighlight">\(n\)</span>, y <span class="math notranslate nohighlight">\(A_r\)</span> es el porcentaje del área total de representa dicha clase:</p>
<p><span class="math notranslate nohighlight">\(L_r = \frac{L_{clase}}{L_{total}}\)</span></p>
<p><span class="math notranslate nohighlight">\(A_r = \frac{A_{clase}}{A_{total}}\)</span></p>
<p>Finalmente, la susceptibilidad de una celda es igual a la sumatoria del peso de cada clase (<span class="math notranslate nohighlight">\(w\)</span>) a la que pertenece en cada variable:</p>
<p><span class="math notranslate nohighlight">\(S^n = \sum w = w_{pendiente} + w_{geologia} + w_{coberturas} + ...w_{n} \)</span></p>
<div class="figure align-default" id="likehood">
<a class="reference internal image-reference" href="https://www.researchgate.net/profile/Jangwon-Suh-3/publication/303875920/figure/fig1/AS:371153064480768&#64;1465501194778/Example-for-calculating-frequency-ratio-using-raster-grids-modified-from-Oh-et-al.png"><img alt="likehood" src="https://www.researchgate.net/profile/Jangwon-Suh-3/publication/303875920/figure/fig1/AS:371153064480768&#64;1465501194778/Example-for-calculating-frequency-ratio-using-raster-grids-modified-from-Oh-et-al.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 30 </span><span class="caption-text">Método de <em>Frequency ratio</em>. Tomado de Suh et al. (2015)</span><a class="headerlink" href="#likehood" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="statistical-index-model">
<h3><em>Statistical index model</em><a class="headerlink" href="#statistical-index-model" title="Permalink to this headline">¶</a></h3>
<p>El valor del peso para cada clase en el método <em>Statistical index model</em> es definido como el logaritmo natural de la densidad de movimientos en masa en una clase (<span class="math notranslate nohighlight">\(\rho_{clase}\)</span>) dividido la densidad de deslizamientos en toda la zona de estudio (<span class="math notranslate nohighlight">\(\rho_{total}\)</span>), de acuerdo con la siguiente ecuación:</p>
<p><span class="math notranslate nohighlight">\(w_{ij}^n = \ln(\frac{\rho_{clase}}{\rho_{total}}) = \ln(\frac{\frac{N_{ij}}{S_{ij}}}{\frac{N}{S}}) \)</span></p>
<p>Donde <span class="math notranslate nohighlight">\(w_{ij}^n\)</span> es el peso de la celda <span class="math notranslate nohighlight">\(n\)</span> que pertenece a la clase <span class="math notranslate nohighlight">\(i\)</span> de la variable <span class="math notranslate nohighlight">\(j\)</span>. <span class="math notranslate nohighlight">\(\rho_{clase}\)</span> es la densidad de deslizamientos de la clase <span class="math notranslate nohighlight">\(i\)</span> del parámetro <span class="math notranslate nohighlight">\(j\)</span>, calculado a  partir de <span class="math notranslate nohighlight">\(N_{ij}\)</span> como el número de pixeles con MenM en una cierta clase <span class="math notranslate nohighlight">\(i\)</span> del parametro <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(S_{ij} como el número de pixeles de la clase \)</span>i<span class="math notranslate nohighlight">\( del parametro \)</span>j$. N es el total de celdas que corresponden a deslizamientos en todo el mapa y S es el total de celdas del área de estudio.</p>
<p>Finalmente la susceptibilidad a movimientos en masa de cada celda es igual a:</p>
<p><span class="math notranslate nohighlight">\(S^n = \sum w = w_{pendiente} + w_{geologia} + w_{coberturas} + ...w_{n} \)</span></p>
</div>
<div class="section" id="peso-de-la-evidencia-woe">
<h3>Peso de la evidencia (WoE)<a class="headerlink" href="#peso-de-la-evidencia-woe" title="Permalink to this headline">¶</a></h3>
<p>El Peso de la Evidencia, basado en la teoría de la probabilidad Bayesiana, analiza la relación entre las áreas afectadas
por los movimientos en masa y la distribución espacial de los factores condicionantes del terreno. Este método arroja
los pesos de las clases que conforman las variables condicionantes, indicando la presencia e influencia de la clase como parámetro
en la ocurrencia del movimiento en masa. Los pesos positivos (W+)  indican la presencia de la clase como parámetro que
favorece los movimientos en masa y su magnitud indica su correlación. El peso negativo (W-) indica la ausencia de la clase en la ocurrencia de
movimiento en masa.</p>
<p>Dónde <span class="math notranslate nohighlight">\(N_{pix1}\)</span> es el número de pixeles con movimientos en masa (<span class="math notranslate nohighlight">\(S\)</span>) en la clase <span class="math notranslate nohighlight">\(B_i\)</span>, <span class="math notranslate nohighlight">\(N_{pix2}\)</span> número de pixeles con movimientos
en masa que no están presentes en la misma clase <span class="math notranslate nohighlight">\(\hat{B}_i\)</span>, <span class="math notranslate nohighlight">\(N_{pix3}\)</span> es el número de pixeles en la clase que no hay movimientos
en masa <span class="math notranslate nohighlight">\(\hat{S}\)</span> y <span class="math notranslate nohighlight">\(N_{pix4}\)</span> es el número de pixeles en la clase donde no hay movimientos en masa <span class="math notranslate nohighlight">\(\hat{S}\)</span> y que no está presente en
la clase  <span class="math notranslate nohighlight">\(\hat{B}_i\)</span>.</p>
<div class="figure align-default" id="woe">
<a class="reference internal image-reference" href="https://i.pinimg.com/564x/70/a4/d5/70a4d5ecbab6d6bf9bdb0f914c91dba8.jpg"><img alt="woe" src="https://i.pinimg.com/564x/70/a4/d5/70a4d5ecbab6d6bf9bdb0f914c91dba8.jpg" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 31 </span><span class="caption-text">Método de Peso de la Evidencia.</span><a class="headerlink" href="#woe" title="Permalink to this image">¶</a></p>
</div>
<p><span class="math notranslate nohighlight">\(C = W^+ - W^-\)</span></p>
<p>Y el contraste C refleja el espacio de asociación respecto a la clase en la predicción del movimiento en masa, la cual
es cero cuando la clase no afecta, es positivo cuando existe una correlación directa y negativo cuando existe una correlación inversa con la distribución de movimientos en masa.</p>
</div>
<div class="section" id="evidential-belief-funtion-ebf">
<h3><em>Evidential Belief Funtion</em> (EBF)<a class="headerlink" href="#evidential-belief-funtion-ebf" title="Permalink to this headline">¶</a></h3>
<p>El modelo EBF (Dempster - Shafer) consiste en el grado de <em>Belief</em> (Bel), <em>Disbelief</em> (Dis), <em>Uncertainty</em> (Unc) y <em>Plausibility</em> (Pls), con valores entre 0 y 1. Bels y Pls representan el límite de probabilidad Bayesiana inferior y superior. Mientras que, Pls es mayor o igual que Bel, y Unc es la diferencia entre ellos, indicando la incertidumbre del resultado.</p>
<p><span class="math notranslate nohighlight">\(Wc_{ij}L=\frac{N(c \cap L)/N(c)}{N(L)-N(c \cap L)/N(S)-N(c)}\)</span></p>
<p><span class="math notranslate nohighlight">\(Belc_{ij}=\frac{Wc_{ij}L}{\sum{Wc_{ij}L}}\)</span></p>
<p><span class="math notranslate nohighlight">\(Wc_{ij} \bar L=\frac{N(c)-N(c \cap L)/N(c)}{N(S)-N(L)-N(c)-N(c \cap L)/N(S)-N(c)}\)</span></p>
<p><span class="math notranslate nohighlight">\(Disc_{ij}=\frac{Wc_{ij} \bar L}{\sum{Wc_{ij} \bar L}}\)</span></p>
<p><span class="math notranslate nohighlight">\(Uncc_{ij}=1-Belc_{ij} - Disc_{ij}\)</span></p>
<div class="figure align-default" id="ebf">
<a class="reference internal image-reference" href="https://www.researchgate.net/profile/Hossein-Nazmfar-2/publication/234059633/figure/fig5/AS:637397922508801&#64;1528978915684/Schematic-relationships-of-evidential-belief-functions-Althuwaynee-et-al-2012.png"><img alt="ebf" src="https://www.researchgate.net/profile/Hossein-Nazmfar-2/publication/234059633/figure/fig5/AS:637397922508801&#64;1528978915684/Schematic-relationships-of-evidential-belief-functions-Althuwaynee-et-al-2012.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Fig. 32 </span><span class="caption-text">Método <em>Evidential Belief Funtion</em>.</span><a class="headerlink" href="#ebf" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="ebf1">
<a class="reference internal image-reference" href="https://i.pinimg.com/564x/4c/90/c3/4c90c30f26e6385e74bb00899a4f7110.jpg"><img alt="ebf1" src="https://i.pinimg.com/564x/4c/90/c3/4c90c30f26e6385e74bb00899a4f7110.jpg" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 33 </span><span class="caption-text">Ejemplo del cálculo de <em>Evidential Belief Funtion</em>.</span><a class="headerlink" href="#ebf1" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="certainty-factor-cf">
<h3><em>Certainty Factor</em> (CF)<a class="headerlink" href="#certainty-factor-cf" title="Permalink to this headline">¶</a></h3>
<p>El valor de CF varía entre -1 y +1. Un valor positivo significa un incremento en la certidumbre de la ocurrencia de deslizamientos, mientras que un valor negativo corresponde a una reducción en dicha certidumbre. Un valor cercano a 0 significa que la probabilidad priori es muy similar a la probabilidad condicional.</p>
<div class="figure align-default" id="cf">
<a class="reference internal image-reference" href="https://i.pinimg.com/originals/ae/1a/55/ae1a558572dffa10393f414d91a5bf24.jpg"><img alt="cf" src="https://i.pinimg.com/originals/ae/1a/55/ae1a558572dffa10393f414d91a5bf24.jpg" style="width: 400px;" /></a>
<p class="caption"><span class="caption-number">Fig. 34 </span><span class="caption-text">Método de <em>Certainty Factor</em>.</span><a class="headerlink" href="#cf" title="Permalink to this image">¶</a></p>
</div>
<p>Donde PPa es la probabilidad condicional de la ocurrencia de un deslizamiento en la clase a. PPs es la probabilidad priori del número total de deslizamientos en el área.</p>
</div>
</div>
<div class="section" id="python">
<h2>Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h2>
<p>En el presente ejemplo, y solo con propósitos pedagógicos, se utlizarán solo tres variables (pendiente, geologia, specto) pero el procedimiento señalado se debera utilizar para todas las variables incorporadas en el modelo de susceptibilidad.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rasterio</span> <span class="k">as</span> <span class="nn">rio</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">~</span>\<span class="n">AppData</span>\<span class="n">Local</span>\<span class="n">Temp</span><span class="o">/</span><span class="n">ipykernel_21984</span><span class="o">/</span><span class="mf">1877902076.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">rasterio</span> <span class="k">as</span> <span class="nn">rio</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;matplotlib&#39;
</pre></div>
</div>
</div>
</div>
<p>Se importa y ajusta el inventario de eventos, y se crea un vector con el mapa.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/edieraristizabal/Libro_cartoGeotecnia/blob/master/data/Inventario_MenM.tif?raw=true&#39;</span><span class="p">)</span>
<span class="n">inventario</span><span class="o">=</span><span class="n">raster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">raster_mask</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/edieraristizabal/Libro_cartoGeotecnia/blob/master/data/Pendiente.tif?raw=true&#39;</span><span class="p">)</span>
<span class="n">msk</span><span class="o">=</span><span class="n">raster_mask</span><span class="o">.</span><span class="n">read_masks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">msk</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">msk</span><span class="o">==</span><span class="mi">255</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">inventario</span><span class="o">=</span><span class="n">msk</span><span class="o">*</span><span class="n">inventario</span>
<span class="n">inventario_vector</span><span class="o">=</span><span class="n">inventario</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">inventario_vector_MenM</span><span class="o">=</span><span class="n">inventario_vector</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">inventario_vector</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">inventario</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">inventario_vector_MenM</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(910801,)
</pre></div>
</div>
<img alt="_images/08_bivariado_11_1.png" src="_images/08_bivariado_11_1.png" />
</div>
</div>
<p>Para saber cuantas celdas son tipo MenM, es decir con valor 1, se puede utilizar la siguiente función.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MenM</span><span class="o">=</span><span class="p">(</span><span class="n">inventario_vector_MenM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">MenM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1620
</pre></div>
</div>
</div>
</div>
<p>Ahora se deben importar y calcular los W+, W- y C para cada clase de cada variable. Se inicia con el mapa de pendientes. Como está en radianes se pasa a grados, y ademas se convierte en un vector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/edieraristizabal/Libro_cartoGeotecnia/blob/master/data/Pendiente.tif?raw=true&#39;</span><span class="p">)</span>
<span class="n">pendiente</span><span class="o">=</span><span class="n">raster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pendiente</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pendiente</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">pendiente</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pendiente</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
<span class="n">pendiente_vector</span><span class="o">=</span><span class="n">pendiente</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">pendiente_vector_MenM</span><span class="o">=</span><span class="n">pendiente_vector</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">pendiente_vector</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08_bivariado_15_0.png" src="_images/08_bivariado_15_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/edieraristizabal/Libro_cartoGeotecnia/blob/master/data/Aspecto.tif?raw=true&#39;</span><span class="p">)</span>
<span class="n">aspecto</span><span class="o">=</span><span class="n">raster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">aspecto</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">aspecto</span><span class="o">&lt;-</span><span class="mi">100</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">aspecto</span><span class="p">)</span>
<span class="n">aspecto_vector</span><span class="o">=</span><span class="n">aspecto</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">aspecto_vector_MenM</span><span class="o">=</span><span class="n">aspecto_vector</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">aspecto_vector</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aspecto</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(910801,)
</pre></div>
</div>
<img alt="_images/08_bivariado_16_1.png" src="_images/08_bivariado_16_1.png" />
</div>
</div>
<p>Se importa el mapa de Geologia y se convierte en un vector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">raster</span> <span class="o">=</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;https://github.com/edieraristizabal/Libro_cartoGeotecnia/blob/master/data/Geologia_Superficial.tif?raw=true&#39;</span><span class="p">)</span>
<span class="n">geologia</span><span class="o">=</span><span class="n">raster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">geologia</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">geologia</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span><span class="n">geologia</span><span class="p">)</span>
<span class="n">geologia_vector</span><span class="o">=</span><span class="n">geologia</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">geologia_vector_MenM</span><span class="o">=</span><span class="n">geologia_vector</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">geologia_vector</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">geologia</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x7f0f62becd10&gt;
</pre></div>
</div>
<img alt="_images/08_bivariado_18_1.png" src="_images/08_bivariado_18_1.png" />
</div>
</div>
<p>Para saber cuantas celdas tiene el mapa de cada clase, se puede convertir el mapa a un dataframe y utilizar la función value_counts</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;geologia&#39;</span><span class="p">:</span><span class="n">geologia_vector</span><span class="p">})</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;geologia&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.0    515621
2.0     237383
11.0     41720
9.0      37658
8.0      32352
10.0     22405
16.0     18583
6.0       3060
15.0      1850
4.0        169
Name: geologia, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Para calcular el <span class="math notranslate nohighlight">\(W^+\)</span> (wp), <span class="math notranslate nohighlight">\(W^-\)</span> (wn), y <span class="math notranslate nohighlight">\(C\)</span> de cada clase del mapa de pendiente, el cual es un mapa continuo, se debe contar inicialmente cuantas celdas hay en los rangos que se establezcan. Para eso se utiliza el vector que se generó con el mapa de pendiente, y se convierte a una serie de <em>Pandas</em>, de tal forma que permita iterar.</p>
<p>Para este ejemplo el mapa de pendientes se vivide en 5 clases [0-10, 10-20, 20-30, 30-35, &gt;35]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pendiente_serie</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pendiente_vector_MenM</span><span class="p">)</span>
<span class="n">a</span><span class="o">=</span><span class="n">b</span><span class="o">=</span><span class="n">c</span><span class="o">=</span><span class="n">d</span><span class="o">=</span><span class="n">e</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pendiente_serie</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">):</span>
          <span class="n">a</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">10</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">):</span>
          <span class="n">b</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">20</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">):</span>
          <span class="n">c</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">30</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">35</span><span class="p">):</span>
          <span class="n">d</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="o">&gt;=</span><span class="mi">35</span><span class="p">):</span>
          <span class="n">e</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">total</span><span class="o">=</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">total</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>53805 138684 279488 158011 280813 910801
</pre></div>
</div>
</div>
</div>
<p>Posteriormente, se debe calcular el número de celdas de cada clase que tengan MenM. Para eso se multiplican los dos vectores que se crearon (pendiente e inventario). Y se aplica la misma iteración anterior, pero es importante nombrar de forma diferente las variables, para poder utilizar ambas variables generadas a continuación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pendienteconMenM</span><span class="o">=</span><span class="n">pendiente_vector_MenM</span><span class="o">*</span><span class="n">inventario_vector_MenM</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a1</span><span class="o">=</span><span class="n">b1</span><span class="o">=</span><span class="n">c1</span><span class="o">=</span><span class="n">d1</span><span class="o">=</span><span class="n">e1</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">pendienteconMenM</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">):</span>
          <span class="n">a1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">10</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">):</span>
          <span class="n">b1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">20</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">):</span>
          <span class="n">c1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">30</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">35</span><span class="p">):</span>
          <span class="n">d1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="o">&gt;=</span><span class="mi">35</span><span class="p">):</span>
          <span class="n">e1</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">total1</span><span class="o">=</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">e1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">d1</span><span class="p">,</span><span class="n">e1</span><span class="p">,</span><span class="n">total1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13 108 411 301 787 1620
</pre></div>
</div>
</div>
</div>
<p>De acuerdo con la ecuacion del método WoE: <span class="math notranslate nohighlight">\(N_{pix1}\)</span>=a1, son las celdas que pertenecen a la clase a y tienen MenM. <span class="math notranslate nohighlight">\(N_{pix2}\)</span>=total1-a1, son las celdas que no pertenecen a la clase a y que tienen MenM, <span class="math notranslate nohighlight">\(N_{pix3}\)</span>=a-a1, son las celdas que pertenecen a la clase a pero que no tienen MenM. y <span class="math notranslate nohighlight">\(N_{pix4}\)</span>=(b+c+d+e)-(b1+c1+d1+e1), son las celdas que no pertenecen a la clase a y que no tienen MenM.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="o">=</span><span class="n">a1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">a1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">a</span><span class="o">-</span><span class="n">a1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">e1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Con los valores de x1, x2, x3, x4 se calculan el <span class="math notranslate nohighlight">\(W^+\)</span> (wp), el <span class="math notranslate nohighlight">\(W^-\)</span> (Wn) y el Contraste de la siguiente forma:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wp_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wp_a</span><span class="p">,</span> <span class="n">wn_a</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.365127685703442 0.08123986981187707 -2.4463675555153186
</pre></div>
</div>
</div>
</div>
<p>Con el valor del contraste para la clase <span class="math notranslate nohighlight">\(a\)</span> del mapa de pendiente, se genera un mapa de pendiente reclasificado donde todas las celdas que pertenezcan a la clase a ahora tengan el valor del contraste de <span class="math notranslate nohighlight">\(a\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pendiente</span><span class="o">&lt;</span><span class="mi">10</span> <span class="p">)),</span><span class="n">c</span><span class="p">,</span><span class="n">pendiente</span> <span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Ahora se repite el mismo procedimiento para cada una de las clases en las cuales se clasificó el mapa de pendientes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Clase b</span>
<span class="n">x1</span><span class="o">=</span><span class="n">b1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">b1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">b</span><span class="o">-</span><span class="n">b1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">e1</span><span class="p">)</span>

<span class="n">wp_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">20</span> <span class="p">)),</span><span class="n">cont</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>

<span class="c1">#Clase c</span>
<span class="n">x1</span><span class="o">=</span><span class="n">c1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">c1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">c</span><span class="o">-</span><span class="n">c1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">e1</span><span class="p">)</span>

<span class="n">wp_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">20</span> <span class="p">)),</span><span class="n">cont</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>

<span class="c1">#Clase d</span>
<span class="n">x1</span><span class="o">=</span><span class="n">d1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">d1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">d</span><span class="o">-</span><span class="n">d1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">e</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">e1</span><span class="p">)</span>

<span class="n">wp_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">20</span><span class="p">,</span> <span class="n">pendiente_c</span><span class="o">&lt;</span><span class="mi">30</span> <span class="p">)),</span><span class="n">cont</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>

<span class="c1">#Clase e</span>
<span class="n">x1</span><span class="o">=</span><span class="n">e1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">e1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">e</span><span class="o">-</span><span class="n">e1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="p">)</span>

<span class="n">wp_e</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_e</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">pendiente_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span> <span class="n">pendiente_c</span><span class="o">&gt;=</span><span class="mi">30</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">pendiente_c</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:19: RuntimeWarning: invalid value encountered in log
/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:21: RuntimeWarning: invalid value encountered in log
</pre></div>
</div>
</div>
</div>
<p>Se procede a imprimir cada uno de los <span class="math notranslate nohighlight">\(W^+\)</span> y <span class="math notranslate nohighlight">\(W^-\)</span> para detectar valores infinitos que se obtienen de logaritmos de 0, es decir que provienen de clases donde algunos de los numeradores (x1, x2, x3, o x4) es 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">wp_a</span><span class="p">,</span> <span class="n">wn_a</span><span class="p">,</span> <span class="n">wp_b</span><span class="p">,</span> <span class="n">wn_b</span><span class="p">,</span> <span class="n">wp_c</span><span class="p">,</span> <span class="n">wn_c</span><span class="p">,</span> <span class="n">wp_d</span><span class="p">,</span> <span class="n">wn_d</span><span class="p">,</span> <span class="n">wp_e</span><span class="p">,</span> <span class="n">wn_e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.365127685703442 0.08123986981187707 -1.1942405986864522 0.1795582351477149 -0.190531748869874 0.0740267315295358 -0.2986005529725735 0.0827384536897787 0.0883928781942713 -0.0768935487691998
</pre></div>
</div>
</div>
</div>
<p>A continuación se presenta el mapa de pendiente reclasificado por el Contraste (C)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pendiente_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">pendiente_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-2.0507433  -1.373798   -0.38133818  0.16528755         nan]
</pre></div>
</div>
<img alt="_images/08_bivariado_37_1.png" src="_images/08_bivariado_37_1.png" />
</div>
</div>
<p>Este mismo procedimiento se realiza para la variable Aspecto</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aspecto_serie</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">aspecto_vector_MenM</span><span class="p">)</span>
<span class="n">a</span><span class="o">=</span><span class="n">b</span><span class="o">=</span><span class="n">c</span><span class="o">=</span><span class="n">d</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">aspecto_serie</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">):</span>
          <span class="n">a</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">90</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">):</span>
          <span class="n">b</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">180</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">270</span><span class="p">):</span>
          <span class="n">c</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="o">&gt;=</span><span class="mi">270</span><span class="p">):</span>
          <span class="n">d</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">total</span><span class="o">=</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">)</span>

<span class="n">aspectoconMenM</span><span class="o">=</span><span class="n">aspecto_vector_MenM</span><span class="o">*</span><span class="n">inventario_vector_MenM</span>

<span class="n">a1</span><span class="o">=</span><span class="n">b1</span><span class="o">=</span><span class="n">c1</span><span class="o">=</span><span class="n">d1</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">aspectoconMenM</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">):</span>
          <span class="n">a1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">90</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">1800</span><span class="p">):</span>
          <span class="n">b1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="mi">180</span> <span class="o">&lt;=</span> <span class="n">row</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">row</span> <span class="o">&lt;</span> <span class="mi">270</span><span class="p">):</span>
          <span class="n">c1</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">row</span><span class="o">&gt;=</span><span class="mi">270</span><span class="p">):</span>
          <span class="n">d1</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">total1</span><span class="o">=</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span>
<span class="c1">#c1=1 #linea que se debe correr para este ejemplo, mas adelante se explica el motivo.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">d1</span><span class="p">)</span>

<span class="c1">#Clase a</span>
<span class="n">x1</span><span class="o">=</span><span class="n">a1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">a1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">a</span><span class="o">-</span><span class="n">a1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="p">)</span>

<span class="n">wp_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">,</span> <span class="n">aspecto</span><span class="o">&lt;</span><span class="mi">90</span> <span class="p">)),</span><span class="n">cont</span><span class="p">,</span><span class="n">aspecto</span> <span class="p">)</span>

<span class="c1">#Clase b</span>
<span class="n">x1</span><span class="o">=</span><span class="n">b1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">b1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">b</span><span class="o">-</span><span class="n">b1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="p">)</span>

<span class="n">wp_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">90</span><span class="p">,</span> <span class="n">aspecto_c</span><span class="o">&lt;</span><span class="mi">180</span> <span class="p">)),</span><span class="n">cont</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>

<span class="c1">#Clase c</span>
<span class="n">x1</span><span class="o">=</span><span class="n">c1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">c1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">c</span><span class="o">-</span><span class="n">c1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">d</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">d1</span><span class="p">)</span>

<span class="n">wp_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span> <span class="p">(</span><span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">180</span><span class="p">,</span> <span class="n">aspecto_c</span><span class="o">&lt;</span><span class="mi">270</span> <span class="p">)),</span><span class="n">cont</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>

<span class="c1">#Clase d</span>
<span class="n">x1</span><span class="o">=</span><span class="n">d1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">d1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">d</span><span class="o">-</span><span class="n">d1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="p">)</span>

<span class="n">wp_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">aspecto_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">aspecto_c</span><span class="o">&gt;=</span><span class="mi">270</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">aspecto_c</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>151110 128456 306544 323489
271 1349 1 479
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">wp_a</span><span class="p">,</span> <span class="n">wn_a</span><span class="p">,</span> <span class="n">wp_b</span><span class="p">,</span> <span class="n">wn_b</span><span class="p">,</span> <span class="n">wp_c</span><span class="p">,</span> <span class="n">wn_c</span><span class="p">,</span> <span class="n">wp_d</span><span class="p">,</span> <span class="n">wn_d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.252618077557853 0.04353988520764823 1.523565749174001 -0.8782470066234108 -6.5638818947844895 0.41169421280498103 -0.444506540695429 0.18091961138463641
</pre></div>
</div>
</div>
</div>
<p>En este caso wp_c arroja un valor de <em>-inf</em>. Lo cual era de esperarse ya que como habiamos obtenido en la linea de codigo anterior c1=0, es decir no hay celdas de la clase c con MenM.</p>
<p>NOTA: Para eliminar este <em>-inf</em> se vuelve a correr el código para aspecto, pero en este caso se “descomenta” la linea donde se le asigna a c1 un valor de 1. De esta forma se elimina el <em>-inf</em>. Tenga en cuenta que en este caso corresponde a c1, pero para cada caso esto puede ser diferente, por lo tanto se debe realizar esta asignación con la clase que corresponda, o modificar el código de tal forma que si se obtiene un cero se asigna automáticamente un valor de 1. Se prefiere de esta forma manual para poder detectar donde se están realizando los ajustes.</p>
<p>A continuación se presenta el mapa de aspecto reclasificado por el Contraste (C)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">aspecto_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">aspecto_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-6.975576   -1.         -0.6254262  -0.29615796  2.4018128          nan]
</pre></div>
</div>
<img alt="_images/08_bivariado_43_1.png" src="_images/08_bivariado_43_1.png" />
</div>
</div>
<p>Para el mapa de Geologia se realiza un procedimiento similar, pero se debe tener en cuenta en este caso que Geología es una variable categórica, por lo cual no es necesario reclasificarla.</p>
<p>De forma similar se debe calcular el número de celdas que hay en cada clase, y el numero de celdas en cada clase con MenM. Los valores de x1, x2, x3, y x4 se calcula de forma similar, al igual que el <span class="math notranslate nohighlight">\(W^+\)</span>, <span class="math notranslate nohighlight">\(W^-\)</span> y el Contraste.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">d</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">e</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">f</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">g</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">h</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">14</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">j</span><span class="o">=</span><span class="p">(</span><span class="n">geologia</span> <span class="o">==</span> <span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">total</span><span class="o">=</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>

<span class="n">geologiaconMenM</span><span class="o">=</span><span class="n">geologia</span><span class="o">*</span><span class="n">inventario</span>
<span class="n">a1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">b1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">c1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">d1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">e1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">f1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">g1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">h1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">14</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">i1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">j1</span><span class="o">=</span><span class="p">(</span><span class="n">geologiaconMenM</span> <span class="o">==</span> <span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">total1</span><span class="o">=</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">e1</span><span class="o">+</span><span class="n">f1</span><span class="o">+</span><span class="n">g1</span><span class="o">+</span><span class="n">h1</span><span class="o">+</span><span class="n">i1</span><span class="o">+</span><span class="n">j1</span>
<span class="c1">#b1, c1, e1, j1= 1,1,1,1  #linea que se debe correr para este ejemplo, mas adelante se explica el motivo.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">d1</span><span class="p">,</span><span class="n">e1</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="n">g1</span><span class="p">,</span><span class="n">h1</span><span class="p">,</span><span class="n">i1</span><span class="p">,</span><span class="n">j1</span><span class="p">)</span>

<span class="c1">#Clase a</span>
<span class="n">x1</span><span class="o">=</span><span class="n">a1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">a1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">a</span><span class="o">-</span><span class="n">a1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">e1</span><span class="o">+</span><span class="n">f1</span><span class="o">+</span><span class="n">g1</span><span class="o">+</span><span class="n">h1</span><span class="o">+</span><span class="n">i1</span><span class="o">+</span><span class="n">j1</span><span class="p">)</span>

<span class="n">wp_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">geologia</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia</span><span class="p">)</span>

<span class="c1">#Clase b</span>
<span class="n">x1</span><span class="o">=</span><span class="n">b1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">b1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">b</span><span class="o">-</span><span class="n">b1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">e1</span><span class="o">+</span><span class="n">f1</span><span class="o">+</span><span class="n">g1</span><span class="o">+</span><span class="n">h1</span><span class="o">+</span><span class="n">i1</span><span class="o">+</span><span class="n">j1</span><span class="p">)</span>

<span class="n">wp_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">4</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase c</span>
<span class="n">x1</span><span class="o">=</span><span class="n">c1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">c1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">c</span><span class="o">-</span><span class="n">c1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">e1</span><span class="o">+</span><span class="n">f1</span><span class="o">+</span><span class="n">g1</span><span class="o">+</span><span class="n">h1</span><span class="o">+</span><span class="n">i1</span><span class="o">+</span><span class="n">j1</span><span class="p">)</span>

<span class="n">wp_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">6</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase d</span>
<span class="n">x1</span><span class="o">=</span><span class="n">d1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">d1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">d</span><span class="o">-</span><span class="n">d1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">e1</span><span class="o">+</span><span class="n">f1</span><span class="o">+</span><span class="n">g1</span><span class="o">+</span><span class="n">h1</span><span class="o">+</span><span class="n">i1</span><span class="o">+</span><span class="n">j1</span><span class="p">)</span>

<span class="n">wp_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">8</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase e</span>
<span class="n">x1</span><span class="o">=</span><span class="n">e1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">e1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">e</span><span class="o">-</span><span class="n">e1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">f1</span><span class="o">+</span><span class="n">g1</span><span class="o">+</span><span class="n">h1</span><span class="o">+</span><span class="n">i1</span><span class="o">+</span><span class="n">j1</span><span class="p">)</span>

<span class="n">wp_e</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_e</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">9</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase f</span>
<span class="n">x1</span><span class="o">=</span><span class="n">f1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">f1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">f</span><span class="o">-</span><span class="n">f1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">e1</span><span class="o">+</span><span class="n">g1</span><span class="o">+</span><span class="n">h1</span><span class="o">+</span><span class="n">i1</span><span class="o">+</span><span class="n">j1</span><span class="p">)</span>

<span class="n">wp_f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">10</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase g</span>
<span class="n">x1</span><span class="o">=</span><span class="n">g1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">g1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">g</span><span class="o">-</span><span class="n">g1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">f1</span><span class="o">+</span><span class="n">e1</span><span class="o">+</span><span class="n">h1</span><span class="o">+</span><span class="n">i1</span><span class="o">+</span><span class="n">j1</span><span class="p">)</span>

<span class="n">wp_g</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_g</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">11</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase h</span>
<span class="n">x1</span><span class="o">=</span><span class="n">h1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">h1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">h</span><span class="o">-</span><span class="n">h1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">f1</span><span class="o">+</span><span class="n">g1</span><span class="o">+</span><span class="n">e1</span><span class="o">+</span><span class="n">i1</span><span class="o">+</span><span class="n">j1</span><span class="p">)</span>

<span class="n">wp_h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">14</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase i</span>
<span class="n">x1</span><span class="o">=</span><span class="n">i1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">i1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="n">i1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">f1</span><span class="o">+</span><span class="n">g1</span><span class="o">+</span><span class="n">h1</span><span class="o">+</span><span class="n">e1</span><span class="o">+</span><span class="n">j1</span><span class="p">)</span>

<span class="n">wp_i</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_i</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">15</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>

<span class="c1">#Clase j</span>
<span class="n">x1</span><span class="o">=</span><span class="n">j1</span>
<span class="n">x2</span><span class="o">=</span><span class="n">total1</span><span class="o">-</span><span class="n">j1</span>
<span class="n">x3</span><span class="o">=</span><span class="n">j</span><span class="o">-</span><span class="n">j1</span>
<span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="o">+</span><span class="n">h</span><span class="o">+</span><span class="n">e</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">+</span><span class="n">b1</span><span class="o">+</span><span class="n">c1</span><span class="o">+</span><span class="n">d1</span><span class="o">+</span><span class="n">f1</span><span class="o">+</span><span class="n">g1</span><span class="o">+</span><span class="n">h1</span><span class="o">+</span><span class="n">e1</span><span class="o">+</span><span class="n">i1</span><span class="p">)</span>

<span class="n">wp_j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">wn_j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span>
<span class="n">cont</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(((</span><span class="n">x1</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">)))</span><span class="o">/</span><span class="p">((</span><span class="n">x2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x4</span><span class="o">/</span><span class="p">(</span><span class="n">x3</span><span class="o">+</span><span class="n">x4</span><span class="p">))))</span>

<span class="n">geologia_c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">where</span> <span class="p">(</span><span class="n">geologia_c</span><span class="o">==</span><span class="mi">16</span><span class="p">,</span><span class="n">cont</span><span class="p">,</span><span class="n">geologia_c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>237383 169 3060 32352 37658 22405 41720 515621 1850 18583
612 1 1 98 1 43 118 736 13 1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">wp_a</span><span class="p">,</span> <span class="n">wn_a</span><span class="p">,</span> <span class="n">wp_b</span><span class="p">,</span> <span class="n">wn_b</span><span class="p">,</span> <span class="n">wp_c</span><span class="p">,</span> <span class="n">wn_c</span><span class="p">,</span> <span class="n">wp_d</span><span class="p">,</span> <span class="n">wn_d</span><span class="p">,</span> <span class="n">wp_e</span><span class="p">,</span> <span class="n">wn_e</span><span class="p">,</span> <span class="n">wp_f</span><span class="p">,</span> <span class="n">wn_f</span><span class="p">,</span> <span class="n">wp_g</span><span class="p">,</span> <span class="n">wn_g</span><span class="p">,</span> <span class="n">wp_h</span><span class="p">,</span> <span class="n">wn_h</span><span class="p">,</span> <span class="n">wp_i</span><span class="p">,</span> <span class="n">wn_i</span><span class="p">,</span> <span class="n">wp_j</span><span class="p">,</span> <span class="n">wn_j</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3719972196859115 -0.1727805096556783 1.2061496660464985 -0.0004326749733077856 -1.6957296987011459 0.002752779757529654 0.5336837785798685 -0.026280284312496238 -4.206160493471516 0.041683506509891124 0.07619539243600662 -0.0019984389181064706 0.4648947478986488 -0.02879076462367898 -0.2203550895609917 0.22972367754746886 1.3791739176961686 -0.006034509849750083 -3.4998350037515005 0.02003254146609238
</pre></div>
</div>
</div>
</div>
<p>Para este caso de la variable <em>geologia</em> se obtienen valores de 0 para las clases b, c, e y j. Por lo tanto se debe asignar valores de 1 y volver a correr el código.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">geologia_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">geologia_c</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-4.247844   -3.51986755 -1.69848248 -0.45007877  0.07819383  0.49368551
  0.54477773  0.55996406  1.20658234  1.38520843         nan]
</pre></div>
</div>
<img alt="_images/08_bivariado_48_1.png" src="_images/08_bivariado_48_1.png" />
</div>
</div>
<p>Finalmente se calcula el Indice de Susceptibildiad (IS), el cual corresponde a la suma de los mapas reclasificados con el valor del Contraste, de la siguiente forma.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IS</span><span class="o">=</span><span class="n">pendiente_c</span><span class="o">+</span><span class="n">aspecto_c</span><span class="o">+</span><span class="n">geologia_c</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">IS</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/08_bivariado_50_0.png" src="_images/08_bivariado_50_0.png" />
</div>
</div>
<p>Podemos exportar el mapa obtenido en formato Tif.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meta</span><span class="o">=</span><span class="n">raster</span><span class="o">.</span><span class="n">profile</span>
<span class="n">raster_transform</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;transform&#39;</span><span class="p">]</span>
<span class="n">raster_crs</span> <span class="o">=</span> <span class="n">meta</span><span class="p">[</span><span class="s1">&#39;crs&#39;</span><span class="p">]</span>

<span class="k">with</span> <span class="n">rio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;Desktop/IS.TIF&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> 
              <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;Gtiff&#39;</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">pendiente</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">width</span><span class="o">=</span><span class="n">pendiente</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span><span class="n">nodata</span><span class="o">=-</span><span class="mi">999</span><span class="p">,</span><span class="n">crs</span><span class="o">=</span><span class="n">raster_crs</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">raster_transform</span><span class="p">)</span> <span class="k">as</span> <span class="n">dst</span><span class="p">:</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">IS</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="07_heuristico.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Métodos basados en el conocimiento</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="regresionLogistica.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Métodos basados en datos -Regresión logística-</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Edier V. Aristizábal G.<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>